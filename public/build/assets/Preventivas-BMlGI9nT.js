import{r as x,z as k,c as i,o,b as g,u as A,h as C,w as v,a as t,i as m,g as _,d as D,f as V,t as r,F as h,e as w,A as N}from"./app-D6fBSztB.js";import{_ as P}from"./AuthenticatedLayout-_MACS7lg.js";import"./ApplicationLogo-Dh4pLsNN.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const S={class:"py-6"},B={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},E={class:"flex items-center gap-3 mb-4"},F={class:"text-sm text-gray-600"},I=["disabled"],R={key:0,class:"mb-4 px-4 py-3 rounded border border-red-200 bg-red-50 text-red-700 text-sm"},T={class:"bg-white dark:bg-gray-800 rounded shadow overflow-x-auto"},z={class:"min-w-full divide-y divide-gray-200 dark:divide-gray-700"},L={class:"bg-white dark:bg-gray-800 divide-y divide-gray-100 dark:divide-gray-700"},M={key:0},j={key:1},q={class:"px-4 py-4 text-sm text-gray-500 dark:text-gray-300",colspan:"7"},G={class:"px-4 py-3 text-sm text-gray-700 dark:text-gray-200"},O={class:"px-4 py-3 text-sm text-gray-700 dark:text-gray-200"},U={class:"px-4 py-3 text-sm text-gray-700 dark:text-gray-200"},$={class:"px-4 py-3 text-sm text-gray-700 dark:text-gray-200"},H={class:"px-4 py-3 text-sm text-gray-700 dark:text-gray-200"},J={class:"px-4 py-3 text-sm text-gray-700 dark:text-gray-200"},K={class:"px-4 py-3 text-sm text-gray-700 dark:text-gray-200"},tt=Object.assign({name:"AlertasPreventivas"},{__name:"Preventivas",props:{defaultDays:{type:Number,default:7}},setup(b){const l=x(b.defaultDays),p=x([]),n=x(!1),d=x(""),y=async()=>{var c,e,a;n.value=!0,d.value="";try{const{data:s}=await N.get("alertas/preventivas",{params:{days:l.value}});p.value=Array.isArray(s==null?void 0:s.items)?s.items:Array.isArray(s)?s:[]}catch(s){const u=(c=s==null?void 0:s.response)==null?void 0:c.status;u===401?d.value="Tu sesión no está autenticada (401). Inicia sesión nuevamente.":u===419?d.value="La sesión/CSRF ha expirado (419). Recarga la página e inicia sesión.":d.value=((a=(e=s==null?void 0:s.response)==null?void 0:e.data)==null?void 0:a.message)||"No fue posible cargar los datos. Verifica que la API responda y la sesión esté activa.",p.value=[]}finally{n.value=!1}},f=()=>{const c=route("api.alertas.preventivas.export",{days:l.value});window.location.assign(c)};return k(y),(c,e)=>(o(),i(h,null,[g(A(C),{title:"Alertas Preventivas"}),g(P,null,{header:v(()=>e[1]||(e[1]=[t("h2",{class:"font-semibold text-xl text-gray-800 dark:text-gray-200 leading-tight"},[_(" Alertas "),t("span",{class:"text-orange-600"},"Preventivas")],-1)])),default:v(()=>[t("div",S,[t("div",B,[t("div",E,[t("label",F,[e[2]||(e[2]=_(" Días ",-1)),D(t("input",{type:"number",min:"1",class:"ml-2 border rounded px-2 py-1 w-20","onUpdate:modelValue":e[0]||(e[0]=a=>l.value=a)},null,512),[[V,l.value,void 0,{number:!0}]])]),t("button",{class:"px-4 py-2 rounded bg-indigo-600 text-white hover:bg-indigo-700 disabled:opacity-50",disabled:n.value,onClick:y},r(n.value?"Cargando…":"Actualizar"),9,I),t("button",{class:"px-4 py-2 rounded bg-gray-800 text-white hover:bg-gray-900",onClick:f}," Descargar ")]),d.value?(o(),i("div",R,r(d.value),1)):m("",!0),t("div",T,[t("table",z,[e[4]||(e[4]=t("thead",{class:"bg-gray-50 dark:bg-gray-700"},[t("tr",{class:"text-left text-xs font-semibold text-gray-600 dark:text-gray-200 uppercase tracking-wider"},[t("th",{class:"px-4 py-3"},"ID"),t("th",{class:"px-4 py-3"},"Rad. Corto"),t("th",{class:"px-4 py-3"},"Etapa"),t("th",{class:"px-4 py-3"},"Últ. Actuación"),t("th",{class:"px-4 py-3"},"Vencimiento"),t("th",{class:"px-4 py-3"},"Días sin gestión"),t("th",{class:"px-4 py-3"},"Encargado")])],-1)),t("tbody",L,[n.value?(o(),i("tr",M,e[3]||(e[3]=[t("td",{class:"px-4 py-4 text-sm text-gray-500 dark:text-gray-300",colspan:"7"}," Cargando resultados… ",-1)]))):p.value.length===0?(o(),i("tr",j,[t("td",q," Sin resultados para los últimos "+r(l.value)+" días. ",1)])):m("",!0),(o(!0),i(h,null,w(p.value,a=>(o(),i("tr",{key:a.id},[t("td",G,r(a.id),1),t("td",O,r(a.rad_corto??a.radCorto??"-"),1),t("td",U,r(a.etapa??"-"),1),t("td",$,r(a.ultima_actuacion??a.ultActuacion??"-"),1),t("td",H,r(a.vencimiento??"-"),1),t("td",J,r(a.dias_sin_gestion??a.diasSinGestion??"-"),1),t("td",K,r(a.encargado??"-"),1)]))),128))])])])])])]),_:1})],64))}});export{tt as default};
