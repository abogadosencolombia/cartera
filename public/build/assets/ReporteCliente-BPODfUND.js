import{r as p,z as f,c as d,o as i,b as k,a as t,u as A,h as C,i as m,g,d as D,f as w,t as a,F as _,e as V,A as N}from"./app-BQ1fBOAU.js";import{_ as R}from"./AuthenticatedLayout-Bawsgd7W.js";import"./ApplicationLogo-CLvo8GpJ.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const B={class:"py-6"},E={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},I={class:"flex items-center gap-3 mb-4"},$={class:"text-sm text-gray-600"},z=["disabled"],F={key:0,class:"mb-4 px-4 py-3 rounded border border-red-200 bg-red-50 text-red-700 text-sm"},M={class:"bg-white rounded shadow overflow-x-auto"},S={class:"min-w-full divide-y divide-gray-200"},T={class:"bg-white divide-y divide-gray-100"},U={key:0},j={class:"px-4 py-4 text-sm text-gray-500",colspan:"7"},q={class:"px-4 py-3 text-sm text-gray-700"},L={class:"px-4 py-3 text-sm text-gray-700"},O={class:"px-4 py-3 text-sm text-gray-700"},P={class:"px-4 py-3 text-sm text-gray-700"},G={class:"px-4 py-3 text-sm text-gray-700"},H={class:"px-4 py-3 text-sm text-gray-700"},J={class:"px-4 py-3 text-sm text-gray-700"},K={layout:R},tt=Object.assign(K,{__name:"ReporteCliente",props:{defaultDays:{type:Number,default:15}},setup(v){const l=p(v.defaultDays),n=p([]),r=p(!1),c=p(""),x=async()=>{var u,s,e;r.value=!0,c.value="";try{const{data:o}=await N.get("/alertas/reporte-cliente",{params:{days:l.value}});n.value=Array.isArray(o.items)?o.items:[]}catch(o){const y=(u=o==null?void 0:o.response)==null?void 0:u.status,b=((e=(s=o==null?void 0:o.response)==null?void 0:s.data)==null?void 0:e.message)||"No fue posible cargar los datos. Verifica que la API responda y la sesión esté activa.";c.value=(y?`[${y}] `:"")+b,n.value=[]}finally{r.value=!1}},h=()=>{window.location.href=`/api/alertas/reporte-cliente/export?days=${encodeURIComponent(l.value)}`};return f(x),(u,s)=>(i(),d(_,null,[k(A(C),{title:"Alertas - Reporte Cliente"}),t("div",B,[t("div",E,[s[3]||(s[3]=t("h1",{class:"text-2xl font-semibold mb-4"},[g(" Alertas "),t("span",{class:"text-orange-600"},"Reporte cliente")],-1)),t("div",I,[t("label",$,[s[1]||(s[1]=g(" Días ",-1)),D(t("input",{type:"number",class:"ml-2 border rounded px-2 py-1 w-20",min:"1","onUpdate:modelValue":s[0]||(s[0]=e=>l.value=e)},null,512),[[w,l.value,void 0,{number:!0}]])]),t("button",{class:"px-4 py-2 rounded bg-indigo-600 text-white hover:bg-indigo-700 disabled:opacity-50",disabled:r.value,onClick:x},a(r.value?"Cargando…":"Actualizar"),9,z),t("button",{class:"px-4 py-2 rounded bg-gray-800 text-white hover:bg-gray-900",onClick:h}," Descargar ")]),c.value?(i(),d("div",F,a(c.value),1)):m("",!0),t("div",M,[t("table",S,[s[2]||(s[2]=t("thead",{class:"bg-gray-50"},[t("tr",{class:"text-left text-xs font-semibold text-gray-600 uppercase tracking-wider"},[t("th",{class:"px-4 py-3"},"ID"),t("th",{class:"px-4 py-3"},"Rad. Corto"),t("th",{class:"px-4 py-3"},"Etapa"),t("th",{class:"px-4 py-3"},"Últ. Actuación"),t("th",{class:"px-4 py-3"},"Vencimiento"),t("th",{class:"px-4 py-3"},"Días sin gestión"),t("th",{class:"px-4 py-3"},"Encargado")])],-1)),t("tbody",T,[!r.value&&n.value.length===0?(i(),d("tr",U,[t("td",j," Sin resultados para los últimos "+a(l.value)+" días. ",1)])):m("",!0),(i(!0),d(_,null,V(n.value,e=>(i(),d("tr",{key:e.id},[t("td",q,a(e.id),1),t("td",L,a(e.rad_corto),1),t("td",O,a(e.etapa),1),t("td",P,a(e.ultima_actuacion),1),t("td",G,a(e.vencimiento),1),t("td",H,a(e.dias_sin_gestion),1),t("td",J,a(e.encargado),1)]))),128))])])])])])],64))}});export{tt as default};
