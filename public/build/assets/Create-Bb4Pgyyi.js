import{s as zo,l as V,k as _,r as m,c as b,o as f,b as l,u as o,h as To,w as p,a as t,x as Uo,g,t as d,d as z,F as P,e as N,v as T,p as jo,n as Eo,A as Bo}from"./app-CJXh-Pjp.js";import{_ as Oo}from"./AuthenticatedLayout-CjDncLrz.js";import{_ as i}from"./InputError-D6J_Ekxe.js";import{_ as u}from"./InputLabel-DWTjBLJB.js";import{_ as Po}from"./PrimaryButton-D7hB7Y7-.js";import{_ as v}from"./TextInput-A7ldSpJd.js";import{C}from"./vue-select-BLM4skGe.js";import"./ApplicationLogo-BzDRqvbd.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const wo={class:"font-semibold text-xl text-gray-800 dark:text-gray-200 leading-tight"},Mo={class:"py-12"},$o={class:"max-w-4xl mx-auto sm:px-6 lg:px-8"},Do={class:"bg-white dark:bg-gray-800 overflow-hidden shadow-sm sm:rounded-lg"},No={class:"p-6 md:p-8 text-gray-900 dark:text-gray-100"},Fo={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Io={class:"md:col-span-2"},Yo={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},Go=["value"],Jo=["disabled"],Ro=["value"],Lo=["value"],qo={class:"lg:col-span-3"},Zo={class:"md:col-span-2"},Ho={class:"flex items-center justify-end mt-8 border-t pt-6"},te={__name:"Create",props:{casoAClonar:{type:Object,default:null},tiposYSubtipos:{type:Array,default:()=>[]},etapas_procesales:{type:Array,default:()=>[]}},setup(F){var L,q,Z,H,K,Q,W,X,oo,eo,ao,so,ro,lo,to,no,io,uo,co,po;const n=F,U=(e,a=s=>s)=>{const s=m([]),c=m("Escribe para buscar...");let mo=null;return{options:s,onSearch:($,go)=>{if(clearTimeout(mo),$.length<3){if(s.value.length>0&&!$)return;s.value=[],c.value="Escribe al menos 3 caracteres...";return}go(!0),c.value="Buscando...",mo=setTimeout(()=>{try{const D=route(e,{q:$});Bo.get(D).then(O=>{if(Array.isArray(O.data)){const _o=O.data.map(a).filter(Boolean);s.value=_o,c.value=_o.length===0?"No se encontraron resultados.":""}else s.value=[],c.value="Error en la respuesta de la API."}).catch(O=>{console.error(`Error buscando en ${e}:`,O),s.value=[],c.value="Ocurrió un error al buscar."}).finally(()=>go(!1))}catch(D){console.error(`Error de Ziggy: La ruta '${e}' no está definida.`,D),s.value=[],c.value="Error de configuración en la ruta."}},500)},message:c}},j=e=>e?{id:e.id,nombre:e.label||e.nombre}:null,I=e=>e?{id:e.id,name:e.label||e.name}:null,E=e=>{if(!e)return null;if(e.nombre_completo&&e.numero_documento)return e;if(typeof e.label=="string"){const a=e.label.match(/(.*) \((\S+)\)$/);if(a)return{id:e.id,nombre_completo:a[1].trim(),numero_documento:a[2]}}return{id:e.id,nombre_completo:e.label||e.nombre_completo||"Dato no válido",numero_documento:"N/A"}},{options:Y,onSearch:bo,message:fo}=U("cooperativas.search",j),{options:G,onSearch:vo,message:Co}=U("users.search",I),{options:J,onSearch:yo,message:ho}=U("juzgados.search",j),{options:B,onSearch:w,message:M}=U("personas.search",E),r=zo({cooperativa_id:((L=n.casoAClonar)==null?void 0:L.cooperativa_id)||null,user_id:((q=n.casoAClonar)==null?void 0:q.user_id)||null,deudor_id:((Z=n.casoAClonar)==null?void 0:Z.deudor_id)||null,codeudor1_id:((H=n.casoAClonar)==null?void 0:H.codeudor1_id)||null,codeudor2_id:((K=n.casoAClonar)==null?void 0:K.codeudor2_id)||null,juzgado_id:((Q=n.casoAClonar)==null?void 0:Q.juzgado_id)||null,referencia_credito:((W=n.casoAClonar)==null?void 0:W.referencia_credito)||"",tipo_proceso:((X=n.casoAClonar)==null?void 0:X.tipo_proceso)||(n.tiposYSubtipos.length>0?n.tiposYSubtipos[0].nombre:""),estado_proceso:"prejurídico",tipo_garantia_asociada:((oo=n.casoAClonar)==null?void 0:oo.tipo_garantia_asociada)||"codeudor",fecha_apertura:new Date().toISOString().slice(0,10),fecha_vencimiento:((eo=n.casoAClonar)==null?void 0:eo.fecha_vencimiento)||"",monto_total:((so=(ao=n.casoAClonar)==null?void 0:ao.monto_total)==null?void 0:so.toString())||"0",tasa_interes_corriente:((lo=(ro=n.casoAClonar)==null?void 0:ro.tasa_interes_corriente)==null?void 0:lo.toString())||"0",tasa_moratoria:((no=(to=n.casoAClonar)==null?void 0:to.tasa_moratoria)==null?void 0:no.toString())||"0",origen_documental:((io=n.casoAClonar)==null?void 0:io.origen_documental)||"pagaré",clonado_de_id:((uo=n.casoAClonar)==null?void 0:uo.id)||null,subtipo_proceso:((co=n.casoAClonar)==null?void 0:co.subtipo_proceso)||"",etapa_procesal:((po=n.casoAClonar)==null?void 0:po.etapa_procesal)||""}),Ao=V(()=>n.tiposYSubtipos.map(e=>e.nombre)),R=V(()=>{if(!r.tipo_proceso)return[];const e=n.tiposYSubtipos.find(a=>a.nombre===r.tipo_proceso);return e&&e.subtipos?e.subtipos.map(a=>a.nombre):[]});_(()=>r.tipo_proceso,(e,a)=>{e!==a&&(r.subtipo_proceso="")});const y=m(null),h=m(null),A=m(null),k=m(null),S=m(null),x=m(null);if(_(y,e=>r.cooperativa_id=(e==null?void 0:e.id)??null),_(h,e=>r.user_id=(e==null?void 0:e.id)??null),_(A,e=>r.deudor_id=(e==null?void 0:e.id)??null),_(k,e=>r.codeudor1_id=(e==null?void 0:e.id)??null),_(S,e=>r.codeudor2_id=(e==null?void 0:e.id)??null),_(x,e=>r.juzgado_id=(e==null?void 0:e.id)??null),n.casoAClonar){n.casoAClonar.cooperativa&&(y.value=j({id:n.casoAClonar.cooperativa.id,label:n.casoAClonar.cooperativa.nombre}),Y.value=[y.value]),n.casoAClonar.user&&(h.value=I({id:n.casoAClonar.user.id,label:n.casoAClonar.user.name}),G.value=[h.value]),n.casoAClonar.juzgado&&(x.value=j({id:n.casoAClonar.juzgado.id,label:n.casoAClonar.juzgado.nombre}),J.value=[x.value]);const e=[];n.casoAClonar.deudor&&(A.value=E(n.casoAClonar.deudor),e.push(A.value)),n.casoAClonar.codeudor1&&(k.value=E(n.casoAClonar.codeudor1),e.push(k.value)),n.casoAClonar.codeudor2&&(S.value=E(n.casoAClonar.codeudor2),e.push(S.value)),B.value=[...new Map(e.filter(Boolean).map(a=>[a.id,a])).values()]}const ko=V(()=>n.casoAClonar?"Clonando Caso":"Registrar Nuevo Caso"),So=V(()=>n.casoAClonar?`Clonando Caso #${n.casoAClonar.id}`:"Registrar Nuevo Caso"),xo=V(()=>n.casoAClonar?"Crear Copia del Caso":"Guardar Nuevo Caso"),Vo=()=>{r.post(route("casos.store"))};return(e,a)=>(f(),b(P,null,[l(o(To),{title:ko.value},null,8,["title"]),l(Oo,null,{header:p(()=>[t("h2",wo,d(So.value),1)]),default:p(()=>[t("div",Mo,[t("div",$o,[t("div",Do,[t("div",No,[t("form",{onSubmit:Uo(Vo,["prevent"]),class:"space-y-8"},[t("section",null,[a[17]||(a[17]=t("h3",{class:"text-lg font-medium border-b pb-2 mb-6"},"Partes Involucradas",-1)),t("div",Fo,[t("div",null,[l(u,{for:"cooperativa",value:"Cooperativa *"}),l(o(C),{id:"cooperativa",modelValue:y.value,"onUpdate:modelValue":a[0]||(a[0]=s=>y.value=s),options:o(Y),label:"nombre",placeholder:"Escribe para buscar...",onSearch:o(bo),filterable:!1,appendToBody:!0,class:"mt-1 block w-full vue-select-style"},{"no-options":p(()=>[g(d(o(fo)),1)]),_:1},8,["modelValue","options","onSearch"]),l(i,{message:o(r).errors.cooperativa_id,class:"mt-2"},null,8,["message"])]),t("div",null,[l(u,{for:"abogado",value:"Abogado/Gestor a Cargo *"}),l(o(C),{id:"abogado",modelValue:h.value,"onUpdate:modelValue":a[1]||(a[1]=s=>h.value=s),options:o(G),label:"name",placeholder:"Escribe para buscar...",onSearch:o(vo),filterable:!1,appendToBody:!0,class:"mt-1 block w-full vue-select-style"},{"no-options":p(()=>[g(d(o(Co)),1)]),_:1},8,["modelValue","options","onSearch"]),l(i,{message:o(r).errors.user_id,class:"mt-2"},null,8,["message"])]),t("div",Io,[l(u,{for:"deudor",value:"Deudor Principal *"}),l(o(C),{id:"deudor",modelValue:A.value,"onUpdate:modelValue":a[2]||(a[2]=s=>A.value=s),options:o(B),label:"nombre_completo",placeholder:"Escribe para buscar...",onSearch:o(w),filterable:!1,appendToBody:!0,class:"mt-1 block w-full vue-select-style"},{option:p(({nombre_completo:s,numero_documento:c})=>[t("span",null,d(s)+" ("+d(c)+")",1)]),"no-options":p(()=>[g(d(o(M)),1)]),_:1},8,["modelValue","options","onSearch"]),l(i,{message:o(r).errors.deudor_id,class:"mt-2"},null,8,["message"])]),t("div",null,[l(u,{for:"codeudor1",value:"Codeudor 1 (Opcional)"}),l(o(C),{id:"codeudor1",modelValue:k.value,"onUpdate:modelValue":a[3]||(a[3]=s=>k.value=s),options:o(B),label:"nombre_completo",placeholder:"Escribe para buscar...",onSearch:o(w),filterable:!1,appendToBody:!0,class:"mt-1 block w-full vue-select-style"},{option:p(({nombre_completo:s,numero_documento:c})=>[t("span",null,d(s)+" ("+d(c)+")",1)]),"no-options":p(()=>[g(d(o(M)),1)]),_:1},8,["modelValue","options","onSearch"]),l(i,{message:o(r).errors.codeudor1_id,class:"mt-2"},null,8,["message"])]),t("div",null,[l(u,{for:"codeudor2",value:"Codeudor 2 (Opcional)"}),l(o(C),{id:"codeudor2",modelValue:S.value,"onUpdate:modelValue":a[4]||(a[4]=s=>S.value=s),options:o(B),label:"nombre_completo",placeholder:"Escribe para buscar...",onSearch:o(w),filterable:!1,appendToBody:!0,class:"mt-1 block w-full vue-select-style"},{option:p(({nombre_completo:s,numero_documento:c})=>[t("span",null,d(s)+" ("+d(c)+")",1)]),"no-options":p(()=>[g(d(o(M)),1)]),_:1},8,["modelValue","options","onSearch"]),l(i,{message:o(r).errors.codeudor2_id,class:"mt-2"},null,8,["message"])])])]),t("section",null,[a[22]||(a[22]=t("h3",{class:"text-lg font-medium border-b pb-2 mb-6"},"Información del Crédito y Proceso",-1)),t("div",Yo,[t("div",null,[l(u,{for:"referencia_credito",value:"Referencia del Crédito"}),l(v,{modelValue:o(r).referencia_credito,"onUpdate:modelValue":a[5]||(a[5]=s=>o(r).referencia_credito=s),id:"referencia_credito",type:"text",class:"mt-1 block w-full"},null,8,["modelValue"]),l(i,{message:o(r).errors.referencia_credito,class:"mt-2"},null,8,["message"])]),t("div",null,[l(u,{for:"monto_total",value:"Monto Total *"}),l(v,{modelValue:o(r).monto_total,"onUpdate:modelValue":a[6]||(a[6]=s=>o(r).monto_total=s),id:"monto_total",type:"number",step:"0.01",class:"mt-1 block w-full"},null,8,["modelValue"]),l(i,{message:o(r).errors.monto_total,class:"mt-2"},null,8,["message"])]),t("div",null,[l(u,{for:"tasa_interes_corriente",value:"Tasa Interés Corriente (%) *"}),l(v,{modelValue:o(r).tasa_interes_corriente,"onUpdate:modelValue":a[7]||(a[7]=s=>o(r).tasa_interes_corriente=s),id:"tasa_interes_corriente",type:"number",step:"0.01",class:"mt-1 block w-full"},null,8,["modelValue"]),l(i,{message:o(r).errors.tasa_interes_corriente,class:"mt-2"},null,8,["message"])]),t("div",null,[l(u,{for:"tasa_moratoria",value:"Tasa Moratoria (%) *"}),l(v,{modelValue:o(r).tasa_moratoria,"onUpdate:modelValue":a[8]||(a[8]=s=>o(r).tasa_moratoria=s),id:"tasa_moratoria",type:"number",step:"0.01",class:"mt-1 block w-full"},null,8,["modelValue"]),l(i,{message:o(r).errors.tasa_moratoria,class:"mt-2"},null,8,["message"])]),t("div",null,[l(u,{for:"fecha_apertura",value:"Fecha de Apertura *"}),l(v,{modelValue:o(r).fecha_apertura,"onUpdate:modelValue":a[9]||(a[9]=s=>o(r).fecha_apertura=s),id:"fecha_apertura",type:"date",class:"mt-1 block w-full"},null,8,["modelValue"]),l(i,{message:o(r).errors.fecha_apertura,class:"mt-2"},null,8,["message"])]),t("div",null,[l(u,{for:"fecha_vencimiento",value:"Fecha de Vencimiento"}),l(v,{modelValue:o(r).fecha_vencimiento,"onUpdate:modelValue":a[10]||(a[10]=s=>o(r).fecha_vencimiento=s),id:"fecha_vencimiento",type:"date",class:"mt-1 block w-full"},null,8,["modelValue"]),l(i,{message:o(r).errors.fecha_vencimiento,class:"mt-2"},null,8,["message"])]),t("div",null,[l(u,{for:"tipo_proceso",value:"Tipo de Proceso *"}),z(t("select",{"onUpdate:modelValue":a[11]||(a[11]=s=>o(r).tipo_proceso=s),id:"tipo_proceso",class:"mt-1 block w-full border-gray-300 dark:border-gray-700 dark:bg-gray-900 rounded-md shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},[(f(!0),b(P,null,N(Ao.value,s=>(f(),b("option",{key:s,value:s},d(s),9,Go))),128))],512),[[T,o(r).tipo_proceso]]),l(i,{message:o(r).errors.tipo_proceso,class:"mt-2"},null,8,["message"])]),t("div",null,[l(u,{for:"subtipo_proceso",value:"Subtipo de Proceso"}),z(t("select",{"onUpdate:modelValue":a[12]||(a[12]=s=>o(r).subtipo_proceso=s),id:"subtipo_proceso",class:"mt-1 block w-full border-gray-300 dark:border-gray-700 dark:bg-gray-900 rounded-md shadow-sm focus:border-indigo-500 focus:ring-indigo-500",disabled:!R.value.length},[a[18]||(a[18]=t("option",{value:""},"-- Seleccione un subtipo --",-1)),(f(!0),b(P,null,N(R.value,s=>(f(),b("option",{key:s,value:s},d(s),9,Ro))),128))],8,Jo),[[T,o(r).subtipo_proceso]]),l(i,{class:"mt-2",message:o(r).errors.subtipo_proceso},null,8,["message"])]),t("div",null,[l(u,{for:"etapa_procesal",value:"Etapa Procesal"}),z(t("select",{"onUpdate:modelValue":a[13]||(a[13]=s=>o(r).etapa_procesal=s),id:"etapa_procesal",class:"mt-1 block w-full border-gray-300 dark:border-gray-700 dark:bg-gray-900 rounded-md shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},[a[19]||(a[19]=t("option",{value:""},"-- Sin especificar --",-1)),(f(!0),b(P,null,N(F.etapas_procesales,s=>(f(),b("option",{key:s,value:s},d(s),9,Lo))),128))],512),[[T,o(r).etapa_procesal]]),l(i,{class:"mt-2",message:o(r).errors.etapa_procesal},null,8,["message"])]),t("div",qo,[l(u,{for:"juzgado",value:"Juzgado"}),l(o(C),{id:"juzgado",modelValue:x.value,"onUpdate:modelValue":a[14]||(a[14]=s=>x.value=s),options:o(J),label:"nombre",placeholder:"Escribe para buscar un juzgado...",onSearch:o(yo),filterable:!1,appendToBody:!0,class:"mt-1 block w-full vue-select-style"},{"no-options":p(()=>[g(d(o(ho)),1)]),_:1},8,["modelValue","options","onSearch"]),l(i,{class:"mt-2",message:o(r).errors.juzgado_id},null,8,["message"])]),t("div",null,[l(u,{for:"tipo_garantia_asociada",value:"Tipo de Garantía *"}),z(t("select",{"onUpdate:modelValue":a[15]||(a[15]=s=>o(r).tipo_garantia_asociada=s),id:"tipo_garantia_asociada",class:"mt-1 block w-full border-gray-300 dark:border-gray-700 dark:bg-gray-900 rounded-md shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},a[20]||(a[20]=[t("option",null,"codeudor",-1),t("option",null,"hipotecaria",-1),t("option",null,"prendaria",-1),t("option",null,"sin garantía",-1)]),512),[[T,o(r).tipo_garantia_asociada]]),l(i,{message:o(r).errors.tipo_garantia_asociada,class:"mt-2"},null,8,["message"])]),t("div",Zo,[l(u,{for:"origen_documental",value:"Origen Documental *"}),z(t("select",{"onUpdate:modelValue":a[16]||(a[16]=s=>o(r).origen_documental=s),id:"origen_documental",class:"mt-1 block w-full border-gray-300 dark:border-gray-700 dark:bg-gray-900 rounded-md shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},a[21]||(a[21]=[t("option",null,"pagaré",-1),t("option",null,"libranza",-1),t("option",null,"contrato",-1),t("option",null,"otro",-1)]),512),[[T,o(r).origen_documental]]),l(i,{message:o(r).errors.origen_documental,class:"mt-2"},null,8,["message"])])])]),t("div",Ho,[l(o(jo),{href:e.route("casos.index"),class:"text-sm text-gray-600 dark:text-gray-400 hover:underline mr-4"},{default:p(()=>a[23]||(a[23]=[g("Cancelar",-1)])),_:1,__:[23]},8,["href"]),l(Po,{class:Eo({"opacity-25":o(r).processing}),disabled:o(r).processing},{default:p(()=>[g(d(xo.value),1)]),_:1},8,["class","disabled"])])],32)])])])])]),_:1})],64))}};export{te as default};
