import{q,s as B,r as P,c as r,o as i,b as o,u as a,h as I,w as m,a as e,d as k,v as _,g as p,i as g,x as M,F as w,e as S,t as n,n as A,j as D}from"./app-CJXh-Pjp.js";import{_ as G}from"./AuthenticatedLayout-CjDncLrz.js";import{_ as v}from"./InputLabel-DWTjBLJB.js";import{_ as z}from"./PrimaryButton-D7hB7Y7-.js";import{D as L}from"./DangerButton-BT4upccn.js";import{_ as H}from"./Modal-Dfvvi1ej.js";import{_ as $}from"./SecondaryButton-CTekWCLN.js";import{_ as x}from"./InputError-D6J_Ekxe.js";import{_ as E}from"./TextInput-A7ldSpJd.js";import{_ as J}from"./Checkbox-C1dMYn5Z.js";import{r as K}from"./DocumentDuplicateIcon-CREjhsLJ.js";import{r as Q}from"./TrashIcon-DFonUCa6.js";import"./ApplicationLogo-BzDRqvbd.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const R={class:"py-12"},W={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},X={class:"bg-white dark:bg-gray-800 overflow-hidden shadow-sm sm:rounded-lg mb-8"},Y={class:"p-6"},Z={class:"grid grid-cols-1 md:grid-cols-3 gap-6"},ee={class:"flex items-end"},te={class:"grid grid-cols-1 lg:grid-cols-3 gap-8"},se={key:0,class:"lg:col-span-1"},ae={class:"bg-white dark:bg-gray-800 overflow-hidden shadow-sm sm:rounded-lg p-6"},oe=["value"],le={class:"space-y-2"},re={class:"ms-2 text-sm text-gray-600 dark:text-gray-400 capitalize"},ie={class:"flex items-center justify-end"},de={key:0,class:"mb-4 bg-green-100 border-l-4 border-green-500 text-green-700 p-4 rounded-md shadow-md",role:"alert"},ne={key:1,class:"mb-4 bg-red-100 border-l-4 border-red-500 text-red-700 p-4 rounded-md shadow-md",role:"alert"},ue={class:"bg-white dark:bg-gray-800 overflow-hidden shadow-sm sm:rounded-lg"},me={class:"p-6 text-gray-900 dark:text-gray-100"},ce={class:"overflow-x-auto"},pe={class:"min-w-full divide-y divide-gray-200 dark:divide-gray-700"},ge={class:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700"},ve={key:0},xe={class:"px-6 py-4 whitespace-nowrap"},fe={class:"text-sm font-medium text-gray-900 dark:text-white"},ye={class:"text-sm text-gray-500 dark:text-gray-400"},be={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400"},ke={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400 capitalize"},_e={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400"},we={key:0,class:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-blue-100 text-blue-800"},he={key:1,class:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-gray-100 text-gray-800"},Ce={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium space-x-4"},Ve=["onClick"],Ne=["onClick","disabled","title"],Pe={class:"p-6"},Se={key:0,class:"mt-2 text-sm text-gray-600 dark:text-gray-400"},Ae={class:"font-bold"},De={class:"mt-6 flex justify-end"},He={__name:"Index",props:{plantillas:Array,cooperativas:Array,tipos_proceso:Array,filtros:Object,can:Object},setup(u){const y=u,b=q(),l=B({nombre:"",tipo:"demanda",cooperativa_id:null,version:"",aplica_a:[],archivo:null}),c=P({tipo:y.filtros.tipo||"",activa:y.filtros.activa===""||y.filtros.activa===null?"":y.filtros.activa}),F=()=>{l.post(route("plantillas.store"),{onSuccess:()=>l.reset()})},h=P(!1),f=P(null),T=d=>{f.value=d,h.value=!0},O=()=>{D.delete(route("plantillas.destroy",f.value.id),{preserveScroll:!0,onSuccess:()=>C()})},C=()=>{h.value=!1,f.value=null},U=d=>{confirm(`¿Estás seguro de que quieres clonar la plantilla "${d.nombre}"?`)&&D.post(route("plantillas.clonar",d.id),{},{preserveScroll:!0})},V=()=>{const d={...c.value};Object.keys(d).forEach(t=>{(d[t]===""||d[t]===null)&&delete d[t]}),D.get(route("plantillas.index"),d,{preserveState:!0,replace:!0})},j=()=>{c.value={tipo:"",activa:""},V()};return(d,t)=>(i(),r(w,null,[o(a(I),{title:"Gestión de Plantillas"}),o(G,null,{header:m(()=>t[8]||(t[8]=[e("h2",{class:"font-semibold text-xl text-gray-800 dark:text-gray-200 leading-tight"}," Arsenal de Plantillas de Documentos ",-1)])),default:m(()=>[e("div",R,[e("div",W,[e("div",X,[e("div",Y,[t[14]||(t[14]=e("h3",{class:"text-lg font-medium text-gray-900 dark:text-gray-100 mb-4"},"Panel de Control del Arsenal",-1)),e("div",Z,[e("div",null,[t[10]||(t[10]=e("label",{for:"filtro_tipo",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Filtrar por Tipo",-1)),k(e("select",{"onUpdate:modelValue":t[0]||(t[0]=s=>c.value.tipo=s),onChange:V,id:"filtro_tipo",class:"mt-1 block w-full border-gray-300 dark:border-gray-700 dark:bg-gray-900 rounded-md shadow-sm"},t[9]||(t[9]=[e("option",{value:""},"Todos los Tipos",-1),e("option",{value:"demanda"},"Demanda",-1),e("option",{value:"carta"},"Carta",-1),e("option",{value:"medida cautelar"},"Medida Cautelar",-1),e("option",{value:"notificación"},"Notificación",-1),e("option",{value:"otros"},"Otros",-1)]),544),[[_,c.value.tipo]])]),e("div",null,[t[12]||(t[12]=e("label",{for:"filtro_activa",class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Filtrar por Estado",-1)),k(e("select",{"onUpdate:modelValue":t[1]||(t[1]=s=>c.value.activa=s),onChange:V,id:"filtro_activa",class:"mt-1 block w-full border-gray-300 dark:border-gray-700 dark:bg-gray-900 rounded-md shadow-sm"},t[11]||(t[11]=[e("option",{value:""},"Todos los Estados",-1),e("option",{value:"1"},"Solo Activas",-1),e("option",{value:"0"},"Solo Inactivas",-1)]),544),[[_,c.value.activa]])]),e("div",ee,[o($,{onClick:j,class:"w-full justify-center h-10"},{default:m(()=>t[13]||(t[13]=[p("Limpiar Filtros",-1)])),_:1,__:[13]})])])])]),e("div",te,[u.can.create_plantillas?(i(),r("div",se,[e("div",ae,[t[18]||(t[18]=e("h3",{class:"text-lg font-medium text-gray-900 dark:text-gray-100"}," Cargar Nueva Plantilla ",-1)),t[19]||(t[19]=e("p",{class:"mt-1 text-sm text-gray-600 dark:text-gray-400"}," Sube archivos .docx para usarlos como plantillas. ",-1)),e("form",{onSubmit:M(F,["prevent"]),class:"mt-6 space-y-6"},[e("div",null,[o(v,{for:"nombre",value:"Nombre de la Plantilla"}),o(E,{modelValue:a(l).nombre,"onUpdate:modelValue":t[2]||(t[2]=s=>a(l).nombre=s),id:"nombre",type:"text",class:"mt-1 block w-full",required:""},null,8,["modelValue"]),o(x,{message:a(l).errors.nombre,class:"mt-2"},null,8,["message"])]),e("div",null,[o(v,{for:"cooperativa_id",value:"Asignar a Cooperativa (Opcional)"}),k(e("select",{"onUpdate:modelValue":t[3]||(t[3]=s=>a(l).cooperativa_id=s),id:"cooperativa_id",class:"mt-1 block w-full border-gray-300 dark:border-gray-700 dark:bg-gray-900 rounded-md shadow-sm"},[t[15]||(t[15]=e("option",{value:null},"-- Plantilla Global --",-1)),(i(!0),r(w,null,S(u.cooperativas,s=>(i(),r("option",{key:s.id,value:s.id},n(s.nombre),9,oe))),128))],512),[[_,a(l).cooperativa_id]]),o(x,{message:a(l).errors.cooperativa_id,class:"mt-2"},null,8,["message"])]),e("div",null,[o(v,{for:"tipo",value:"Tipo de Documento"}),k(e("select",{"onUpdate:modelValue":t[4]||(t[4]=s=>a(l).tipo=s),id:"tipo",class:"mt-1 block w-full border-gray-300 dark:border-gray-700 dark:bg-gray-900 rounded-md shadow-sm"},t[16]||(t[16]=[e("option",{value:"demanda"},"Demanda",-1),e("option",{value:"carta"},"Carta",-1),e("option",{value:"medida cautelar"},"Medida Cautelar",-1),e("option",{value:"notificación"},"Notificación",-1),e("option",{value:"otros"},"Otros",-1)]),512),[[_,a(l).tipo]]),o(x,{message:a(l).errors.tipo,class:"mt-2"},null,8,["message"])]),e("div",null,[o(v,{for:"version",value:"Versión (Opcional)"}),o(E,{modelValue:a(l).version,"onUpdate:modelValue":t[5]||(t[5]=s=>a(l).version=s),id:"version",type:"text",class:"mt-1 block w-full"},null,8,["modelValue"]),o(x,{message:a(l).errors.version,class:"mt-2"},null,8,["message"])]),e("div",null,[o(v,{value:"Aplica a Tipos de Proceso (Opcional)",class:"mb-2"}),e("div",le,[(i(!0),r(w,null,S(u.tipos_proceso,s=>(i(),r("label",{key:s,class:"flex items-center"},[o(J,{checked:a(l).aplica_a,"onUpdate:checked":t[6]||(t[6]=N=>a(l).aplica_a=N),value:s},null,8,["checked","value"]),e("span",re,n(s),1)]))),128))]),o(x,{message:a(l).errors.aplica_a,class:"mt-2"},null,8,["message"])]),e("div",null,[o(v,{for:"archivo",value:"Archivo (.docx)"}),e("input",{id:"archivo",type:"file",onInput:t[7]||(t[7]=s=>a(l).archivo=s.target.files[0]),class:"mt-1 block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-indigo-50 file:text-indigo-700 hover:file:bg-indigo-100"},null,32),o(x,{message:a(l).errors.archivo,class:"mt-2"},null,8,["message"])]),e("div",ie,[o(z,{class:A({"opacity-25":a(l).processing}),disabled:a(l).processing},{default:m(()=>t[17]||(t[17]=[p(" Guardar Plantilla ",-1)])),_:1,__:[17]},8,["class","disabled"])])],32)])])):g("",!0),e("div",{class:A([u.can.create_plantillas?"lg:col-span-2":"lg:col-span-3"])},[a(b).props.flash.success?(i(),r("div",de,[t[20]||(t[20]=e("p",{class:"font-bold"},"¡Éxito!",-1)),e("p",null,n(a(b).props.flash.success),1)])):g("",!0),a(b).props.flash.error?(i(),r("div",ne,[t[21]||(t[21]=e("p",{class:"font-bold"},"¡Acción Bloqueada!",-1)),e("p",null,n(a(b).props.flash.error),1)])):g("",!0),e("div",ue,[e("div",me,[t[24]||(t[24]=e("h3",{class:"text-lg font-medium mb-4"},"Plantillas Disponibles",-1)),e("div",ce,[e("table",pe,[t[23]||(t[23]=e("thead",{class:"bg-gray-50 dark:bg-gray-700"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},"Nombre / Versión"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},"Cooperativa"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},"Tipo"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},"En Uso"),e("th",{class:"relative px-6 py-3"},[e("span",{class:"sr-only"},"Acciones")])])],-1)),e("tbody",ge,[u.plantillas.length===0?(i(),r("tr",ve,t[22]||(t[22]=[e("td",{colspan:"5",class:"px-6 py-8 text-center text-gray-500 dark:text-gray-400"}," No se encontraron plantillas con los filtros aplicados. ",-1)]))):(i(!0),r(w,{key:1},S(u.plantillas,s=>(i(),r("tr",{key:s.id,class:"hover:bg-gray-50 dark:hover:bg-gray-700/50"},[e("td",xe,[e("div",fe,n(s.nombre),1),e("div",ye,"Ver. "+n(s.version||"N/A"),1)]),e("td",be,n(s.cooperativa?s.cooperativa.nombre:"Global"),1),e("td",ke,n(s.tipo),1),e("td",_e,[s.documentos_generados_count>0?(i(),r("span",we," Sí ("+n(s.documentos_generados_count)+") ",1)):(i(),r("span",he," No "))]),e("td",Ce,[u.can.create_plantillas?(i(),r("button",{key:0,onClick:N=>U(s),class:"text-indigo-600 hover:text-indigo-900 dark:text-indigo-400 dark:hover:text-indigo-300",title:"Clonar Plantilla"},[o(a(K),{class:"h-5 w-5"})],8,Ve)):g("",!0),u.can.create_plantillas?(i(),r("button",{key:1,onClick:N=>T(s),disabled:s.documentos_generados_count>0,class:A([s.documentos_generados_count>0?"text-gray-400 cursor-not-allowed":"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300"]),title:s.documentos_generados_count>0?"No se puede eliminar, plantilla en uso":"Eliminar Plantilla"},[o(a(Q),{class:"h-5 w-5"})],10,Ne)):g("",!0)])]))),128))])])])])])],2)])])]),o(H,{show:h.value,onClose:C},{default:m(()=>[e("div",Pe,[t[29]||(t[29]=e("h2",{class:"text-lg font-medium text-gray-900 dark:text-gray-100"}," ¿Eliminar Plantilla? ",-1)),f.value?(i(),r("p",Se,[t[25]||(t[25]=p(" Estás a punto de eliminar permanentemente la plantilla ",-1)),e("span",Ae,n(f.value.nombre),1),t[26]||(t[26]=p(". Esta acción no se puede deshacer. ",-1))])):g("",!0),e("div",De,[o($,{onClick:C},{default:m(()=>t[27]||(t[27]=[p(" Cancelar ",-1)])),_:1,__:[27]}),o(L,{class:"ms-3",onClick:O},{default:m(()=>t[28]||(t[28]=[p(" Sí, Eliminar ",-1)])),_:1,__:[28]})])])]),_:1},8,["show"])]),_:1})],64))}};export{He as default};
