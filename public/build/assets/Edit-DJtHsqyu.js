import{q as U,l as E,s as S,k as A,r as P,c as u,o as n,b as r,u as a,h as T,w as k,a as l,x as D,d as p,F as g,e as b,t as c,v as _,g as V,i as h,p as N,n as $,A as F}from"./app-D6fBSztB.js";import{_ as I}from"./AuthenticatedLayout-_MACS7lg.js";import{_ as d}from"./InputError-HqrJXC_t.js";import{_ as i}from"./InputLabel-B78_-JR2.js";import{_ as M}from"./PrimaryButton-CvtAZ7tP.js";import{_ as f}from"./TextInput-Bef9WMy8.js";import{_ as C}from"./Textarea-BjqHcdej.js";import{_ as O}from"./Checkbox-BU1XqNcn.js";import{C as B}from"./vue-select-BzIV980o.js";import"./ApplicationLogo-Dh4pLsNN.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const G={class:"flex items-center gap-3"},J={class:"font-semibold text-xl text-gray-800 dark:text-gray-200 leading-tight"},L={class:"text-indigo-500"},Y={key:0,class:"px-2 py-0.5 text-xs rounded bg-red-100 text-red-700"},H={class:"py-12"},R={class:"max-w-4xl mx-auto sm:px-6 lg:px-8"},K={class:"bg-white dark:bg-gray-800 overflow-hidden shadow-sm sm:rounded-lg"},Q={class:"p-6 md:p-8 text-gray-900 dark:text-gray-100"},W=["disabled"],X={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Z=["value"],ee=["value"],oe={class:"md:col-span-2"},ae=["value"],se=["value"],le=["value"],re={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},te=["value"],de=["value"],ie={class:"lg:col-span-3"},ue={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},ne=["disabled"],me={class:"md:col-span-2"},ce={class:"md:col-span-2 rounded-lg border border-gray-200 dark:border-gray-700 p-4 bg-gray-50 dark:bg-gray-900/40"},pe={class:"flex items-start gap-3"},_e={class:"grow"},ge={key:0,class:"mt-4"},be={class:"flex items-center justify-end mt-8 border-t pt-6"},ze={__name:"Edit",props:{caso:{type:Object,required:!0},cooperativas:{type:Array,default:()=>[]},abogadosYGestores:{type:Array,default:()=>[]},personas:{type:Array,default:()=>[]},subtipos_proceso:{type:Array,default:()=>[]},etapas_procesales:{type:Array,default:()=>[]}},setup(m){const t=m,w=U().props.auth.user,y=E(()=>t.caso.bloqueado&&w.tipo_usuario!=="admin"),s=S({_method:"PATCH",cooperativa_id:t.caso.cooperativa_id,user_id:t.caso.user_id,deudor_id:t.caso.deudor_id,codeudor1_id:t.caso.codeudor1_id,codeudor2_id:t.caso.codeudor2_id,referencia_credito:t.caso.referencia_credito,tipo_proceso:t.caso.tipo_proceso,estado_proceso:t.caso.estado_proceso,tipo_garantia_asociada:t.caso.tipo_garantia_asociada,fecha_apertura:t.caso.fecha_apertura?new Date(t.caso.fecha_apertura).toISOString().slice(0,10):"",fecha_vencimiento:t.caso.fecha_vencimiento?new Date(t.caso.fecha_vencimiento).toISOString().slice(0,10):"",monto_total:t.caso.monto_total,tasa_interes_corriente:t.caso.tasa_interes_corriente,tasa_moratoria:t.caso.tasa_moratoria,origen_documental:t.caso.origen_documental,etapa_actual:t.caso.etapa_actual,bloqueado:!!t.caso.bloqueado,motivo_bloqueo:t.caso.motivo_bloqueo??"",medio_contacto:t.caso.medio_contacto,notas_legales:t.caso.notas_legales,subtipo_proceso:t.caso.subtipo_proceso||"",etapa_procesal:t.caso.etapa_procesal||"",juzgado_id:t.caso.juzgado_id||null});A(()=>s.bloqueado,v=>{v||(s.motivo_bloqueo="")});const x=P(t.caso.juzgado?[t.caso.juzgado]:[]);let q=null;const j=(v,o)=>{clearTimeout(q),v.length>=3&&(o(!0),q=setTimeout(()=>{F.get(route("juzgados.search",{q:v})).then(e=>{x.value=e.data}).catch(e=>console.error("Error buscando juzgados:",e)).finally(()=>o(!1))},500))},z=()=>{s.put(route("casos.update",t.caso.id))};return(v,o)=>(n(),u(g,null,[r(a(T),{title:"Editar Caso #"+m.caso.id},null,8,["title"]),r(I,null,{header:k(()=>[l("div",G,[l("h2",J,[o[20]||(o[20]=V(" Editando Caso ",-1)),l("span",L,"#"+c(m.caso.id),1)]),m.caso.bloqueado?(n(),u("span",Y,"Bloqueado")):h("",!0)])]),default:k(()=>[l("div",H,[l("div",R,[l("div",K,[l("div",Q,[l("form",{onSubmit:D(z,["prevent"]),class:"space-y-8"},[l("fieldset",{disabled:y.value,class:"space-y-8"},[l("section",null,[o[23]||(o[23]=l("h3",{class:"text-lg font-medium border-b pb-2 mb-6"},"Partes Involucradas",-1)),l("div",X,[l("div",null,[r(i,{for:"cooperativa_id",value:"Cooperativa *"}),p(l("select",{"onUpdate:modelValue":o[0]||(o[0]=e=>a(s).cooperativa_id=e),id:"cooperativa_id",class:"mt-1 block w-full border-gray-300 dark:border-gray-700 dark:bg-gray-900 rounded-md shadow-sm"},[(n(!0),u(g,null,b(m.cooperativas,e=>(n(),u("option",{key:e.id,value:e.id},c(e.nombre),9,Z))),128))],512),[[_,a(s).cooperativa_id]]),r(d,{message:a(s).errors.cooperativa_id,class:"mt-2"},null,8,["message"])]),l("div",null,[r(i,{for:"user_id",value:"Abogado/Gestor a Cargo *"}),p(l("select",{"onUpdate:modelValue":o[1]||(o[1]=e=>a(s).user_id=e),id:"user_id",class:"mt-1 block w-full border-gray-300 dark:border-gray-700 dark:bg-gray-900 rounded-md shadow-sm"},[(n(!0),u(g,null,b(m.abogadosYGestores,e=>(n(),u("option",{key:e.id,value:e.id},c(e.name),9,ee))),128))],512),[[_,a(s).user_id]]),r(d,{message:a(s).errors.user_id,class:"mt-2"},null,8,["message"])]),l("div",oe,[r(i,{for:"deudor_id",value:"Deudor Principal *"}),p(l("select",{"onUpdate:modelValue":o[2]||(o[2]=e=>a(s).deudor_id=e),id:"deudor_id",class:"mt-1 block w-full border-gray-300 dark:border-gray-700 dark:bg-gray-900 rounded-md shadow-sm"},[(n(!0),u(g,null,b(m.personas,e=>(n(),u("option",{key:e.id,value:e.id},c(e.nombre_completo)+" ("+c(e.numero_documento)+")",9,ae))),128))],512),[[_,a(s).deudor_id]]),r(d,{message:a(s).errors.deudor_id,class:"mt-2"},null,8,["message"])]),l("div",null,[r(i,{for:"codeudor1_id",value:"Codeudor 1 (Opcional)"}),p(l("select",{"onUpdate:modelValue":o[3]||(o[3]=e=>a(s).codeudor1_id=e),id:"codeudor1_id",class:"mt-1 block w-full border-gray-300 dark:border-gray-700 dark:bg-gray-900 rounded-md shadow-sm"},[o[21]||(o[21]=l("option",{value:null},"Ninguno",-1)),(n(!0),u(g,null,b(m.personas,e=>(n(),u("option",{key:e.id,value:e.id},c(e.nombre_completo)+" ("+c(e.numero_documento)+")",9,se))),128))],512),[[_,a(s).codeudor1_id]]),r(d,{message:a(s).errors.codeudor1_id,class:"mt-2"},null,8,["message"])]),l("div",null,[r(i,{for:"codeudor2_id",value:"Codeudor 2 (Opcional)"}),p(l("select",{"onUpdate:modelValue":o[4]||(o[4]=e=>a(s).codeudor2_id=e),id:"codeudor2_id",class:"mt-1 block w-full border-gray-300 dark:border-gray-700 dark:bg-gray-900 rounded-md shadow-sm"},[o[22]||(o[22]=l("option",{value:null},"Ninguno",-1)),(n(!0),u(g,null,b(m.personas,e=>(n(),u("option",{key:e.id,value:e.id},c(e.nombre_completo)+" ("+c(e.numero_documento)+")",9,le))),128))],512),[[_,a(s).codeudor2_id]]),r(d,{message:a(s).errors.codeudor2_id,class:"mt-2"},null,8,["message"])])])]),l("section",null,[o[28]||(o[28]=l("h3",{class:"text-lg font-medium border-b pb-2 mb-6"},"Información del Crédito y Proceso",-1)),l("div",re,[l("div",null,[r(i,{for:"referencia_credito",value:"Referencia del Crédito"}),r(f,{modelValue:a(s).referencia_credito,"onUpdate:modelValue":o[5]||(o[5]=e=>a(s).referencia_credito=e),id:"referencia_credito",type:"text",class:"mt-1 block w-full"},null,8,["modelValue"]),r(d,{message:a(s).errors.referencia_credito,class:"mt-2"},null,8,["message"])]),l("div",null,[r(i,{for:"monto_total",value:"Monto Total *"}),r(f,{modelValue:a(s).monto_total,"onUpdate:modelValue":o[6]||(o[6]=e=>a(s).monto_total=e),id:"monto_total",type:"number",step:"0.01",class:"mt-1 block w-full"},null,8,["modelValue"]),r(d,{message:a(s).errors.monto_total,class:"mt-2"},null,8,["message"])]),l("div",null,[r(i,{for:"tasa_interes_corriente",value:"Tasa Interés Corriente (%)"}),r(f,{modelValue:a(s).tasa_interes_corriente,"onUpdate:modelValue":o[7]||(o[7]=e=>a(s).tasa_interes_corriente=e),id:"tasa_interes_corriente",type:"number",step:"0.01",class:"mt-1 block w-full"},null,8,["modelValue"]),r(d,{message:a(s).errors.tasa_interes_corriente,class:"mt-2"},null,8,["message"])]),l("div",null,[r(i,{for:"tasa_moratoria",value:"Tasa Moratoria (%)"}),r(f,{modelValue:a(s).tasa_moratoria,"onUpdate:modelValue":o[8]||(o[8]=e=>a(s).tasa_moratoria=e),id:"tasa_moratoria",type:"number",step:"0.01",class:"mt-1 block w-full"},null,8,["modelValue"]),r(d,{message:a(s).errors.tasa_moratoria,class:"mt-2"},null,8,["message"])]),l("div",null,[r(i,{for:"fecha_apertura",value:"Fecha de Apertura *"}),r(f,{modelValue:a(s).fecha_apertura,"onUpdate:modelValue":o[9]||(o[9]=e=>a(s).fecha_apertura=e),id:"fecha_apertura",type:"date",class:"mt-1 block w-full"},null,8,["modelValue"]),r(d,{message:a(s).errors.fecha_apertura,class:"mt-2"},null,8,["message"])]),l("div",null,[r(i,{for:"fecha_vencimiento",value:"Fecha de Vencimiento"}),r(f,{modelValue:a(s).fecha_vencimiento,"onUpdate:modelValue":o[10]||(o[10]=e=>a(s).fecha_vencimiento=e),id:"fecha_vencimiento",type:"date",class:"mt-1 block w-full"},null,8,["modelValue"]),r(d,{message:a(s).errors.fecha_vencimiento,class:"mt-2"},null,8,["message"])]),l("div",null,[r(i,{for:"tipo_proceso",value:"Tipo de Proceso *"}),p(l("select",{"onUpdate:modelValue":o[11]||(o[11]=e=>a(s).tipo_proceso=e),id:"tipo_proceso",class:"mt-1 block w-full border-gray-300 dark:border-gray-700 dark:bg-gray-900 rounded-md shadow-sm"},o[24]||(o[24]=[l("option",null,"ejecutivo singular",-1),l("option",null,"hipotecario",-1),l("option",null,"prendario",-1),l("option",null,"libranza",-1)]),512),[[_,a(s).tipo_proceso]]),r(d,{message:a(s).errors.tipo_proceso,class:"mt-2"},null,8,["message"])]),l("div",null,[r(i,{for:"subtipo_proceso",value:"Subtipo de Proceso"}),p(l("select",{"onUpdate:modelValue":o[12]||(o[12]=e=>a(s).subtipo_proceso=e),id:"subtipo_proceso",class:"mt-1 block w-full border-gray-300 dark:border-gray-700 dark:bg-gray-900 rounded-md shadow-sm"},[o[25]||(o[25]=l("option",{value:""},"-- Sin especificar --",-1)),(n(!0),u(g,null,b(m.subtipos_proceso,e=>(n(),u("option",{key:e,value:e},c(e),9,te))),128))],512),[[_,a(s).subtipo_proceso]]),r(d,{class:"mt-2",message:a(s).errors.subtipo_proceso},null,8,["message"])]),l("div",null,[r(i,{for:"etapa_procesal",value:"Etapa Procesal"}),p(l("select",{"onUpdate:modelValue":o[13]||(o[13]=e=>a(s).etapa_procesal=e),id:"etapa_procesal",class:"mt-1 block w-full border-gray-300 dark:border-gray-700 dark:bg-gray-900 rounded-md shadow-sm"},[o[26]||(o[26]=l("option",{value:""},"-- Sin especificar --",-1)),(n(!0),u(g,null,b(m.etapas_procesales,e=>(n(),u("option",{key:e,value:e},c(e),9,de))),128))],512),[[_,a(s).etapa_procesal]]),r(d,{class:"mt-2",message:a(s).errors.etapa_procesal},null,8,["message"])]),l("div",ie,[r(i,{for:"juzgado_id_edit",value:"Juzgado"}),r(a(B),{id:"juzgado_id_edit",modelValue:a(s).juzgado_id,"onUpdate:modelValue":o[14]||(o[14]=e=>a(s).juzgado_id=e),options:x.value,label:"nombre",reduce:e=>e.id,placeholder:"Escribe para buscar un juzgado...",onSearch:j,filterable:!1,appendToBody:!0,class:"mt-1 block w-full vue-select-style"},{"no-options":k(()=>o[27]||(o[27]=[V(" Escribe al menos 3 caracteres para buscar... ",-1)])),_:1},8,["modelValue","options","reduce"]),r(d,{class:"mt-2",message:a(s).errors.juzgado_id},null,8,["message"])])])])],8,W),l("section",null,[o[31]||(o[31]=l("h3",{class:"text-lg font-medium border-b pb-2 mb-6"},"Estado y Control del Caso",-1)),l("div",ue,[l("div",null,[r(i,{for:"estado_proceso",value:"Estado del Proceso *"}),p(l("select",{"onUpdate:modelValue":o[15]||(o[15]=e=>a(s).estado_proceso=e),id:"estado_proceso",class:"mt-1 block w-full border-gray-300 dark:border-gray-700 dark:bg-gray-900 rounded-md shadow-sm",disabled:y.value},o[29]||(o[29]=[l("option",{value:"prejurídico"},"Prejurídico",-1),l("option",{value:"demandado"},"Demandado",-1),l("option",{value:"en ejecución"},"En Ejecución",-1),l("option",{value:"sentencia"},"Sentencia",-1),l("option",{value:"cerrado"},"Cerrado",-1)]),8,ne),[[_,a(s).estado_proceso]]),r(d,{message:a(s).errors.estado_proceso,class:"mt-2"},null,8,["message"])]),l("div",null,[r(i,{for:"etapa_actual",value:"Etapa Actual del Proceso"}),r(f,{modelValue:a(s).etapa_actual,"onUpdate:modelValue":o[16]||(o[16]=e=>a(s).etapa_actual=e),id:"etapa_actual",type:"text",class:"mt-1 block w-full",disabled:y.value},null,8,["modelValue","disabled"]),r(d,{message:a(s).errors.etapa_actual,class:"mt-2"},null,8,["message"])]),l("div",me,[r(i,{for:"notas_legales",value:"Notas Legales / Internas"}),r(C,{modelValue:a(s).notas_legales,"onUpdate:modelValue":o[17]||(o[17]=e=>a(s).notas_legales=e),id:"notas_legales",class:"mt-1 block w-full",rows:"4",disabled:y.value},null,8,["modelValue","disabled"]),r(d,{message:a(s).errors.notas_legales,class:"mt-2"},null,8,["message"])]),l("div",ce,[l("div",pe,[r(O,{id:"bloqueado",checked:a(s).bloqueado,"onUpdate:checked":o[18]||(o[18]=e=>a(s).bloqueado=e),disabled:a(w).tipo_usuario!=="admin"},null,8,["checked","disabled"]),l("div",_e,[r(i,{for:"bloqueado",value:"Caso bloqueado"}),o[30]||(o[30]=l("p",{class:"text-sm text-gray-500 dark:text-gray-400"}," Cuando está bloqueado solo un administrador puede modificar el caso. ",-1)),r(d,{message:a(s).errors.bloqueado,class:"mt-2"},null,8,["message"])])]),a(s).bloqueado?(n(),u("div",ge,[r(i,{for:"motivo_bloqueo",value:"Motivo del bloqueo *"}),r(C,{id:"motivo_bloqueo",modelValue:a(s).motivo_bloqueo,"onUpdate:modelValue":o[19]||(o[19]=e=>a(s).motivo_bloqueo=e),modelModifiers:{trim:!0},class:"mt-1 block w-full resize-y min-h-[96px]",rows:"3",maxlength:"1000",placeholder:"Describe la razón del bloqueo…",disabled:a(w).tipo_usuario!=="admin"},null,8,["modelValue","disabled"]),r(d,{message:a(s).errors.motivo_bloqueo,class:"mt-2"},null,8,["message"])])):h("",!0)])])]),l("div",be,[r(a(N),{href:v.route("casos.show",m.caso.id),class:"text-sm text-gray-600 hover:underline mr-4"},{default:k(()=>o[32]||(o[32]=[V("Cancelar",-1)])),_:1,__:[32]},8,["href"]),r(M,{class:$({"opacity-25":a(s).processing}),disabled:a(s).processing||y.value},{default:k(()=>o[33]||(o[33]=[V(" Actualizar Caso ",-1)])),_:1,__:[33]},8,["class","disabled"])])],32)])])])])]),_:1})],64))}};export{ze as default};
