import{s as S,k as V,r as w,l as R,c as d,o as c,b as o,u as r,h as F,w as i,a as e,d as y,f as T,v as _,F as b,e as k,t as u,i as j,n as U,p as E,g as n,j as M}from"./app-D6fBSztB.js";import{b as L,e as O,_ as P}from"./AuthenticatedLayout-_MACS7lg.js";import{_ as z}from"./Pagination-CSAILcR0.js";import{_ as G}from"./Modal-BMJ9k-EC.js";import{D as C}from"./DangerButton-BuSa_7yf.js";import{_ as D}from"./SecondaryButton-DFtNAEDQ.js";import{l as h}from"./lodash-Bh_TLi56.js";import{r as $}from"./ArrowDownTrayIcon-De2fghL-.js";import{r as J}from"./PlusIcon-DJSkn_Zc.js";import"./ApplicationLogo-Dh4pLsNN.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const q={class:"flex justify-between items-center"},H={class:"font-semibold text-xl text-gray-800 leading-tight flex items-center"},K={class:"flex items-center space-x-2"},Q=["href"],W={class:"flex items-center"},X=["href"],Y={class:"flex items-center"},Z={class:"py-12"},ee={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},te={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},se={class:"p-6 bg-white border-b border-gray-200"},oe={class:"mb-4 grid grid-cols-1 md:grid-cols-3 gap-4"},re=["value"],ae={class:"overflow-x-auto"},ie={class:"min-w-full divide-y divide-gray-200"},ne={class:"bg-white divide-y divide-gray-200"},le={key:0},de={class:"px-6 py-4 whitespace-nowrap"},ce={class:"text-sm font-medium text-gray-900"},ue={class:"text-sm text-gray-500 capitalize"},me={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},pe={class:"px-6 py-4 whitespace-nowrap"},ge={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},fe={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},xe={class:"flex justify-end items-center space-x-2"},ye={class:"mt-4"},be={class:"p-6"},he={key:0,class:"mt-1 text-sm text-gray-600"},ve={class:"font-medium"},we={class:"mt-6 flex justify-end"},Ve={__name:"Index",props:{incidentes:Object,filters:Object,usuarios:Array},setup(m){const g=m,l=S({search:g.filters.search||"",estado:g.filters.estado||"",responsable_id:g.filters.responsable_id||""});V(()=>l.data(),h.debounce(function(){l.get(route("admin.incidentes-juridicos.index"),h.pickBy(l.data()),{preserveState:!0,replace:!0})},300),{deep:!0});const f=w(!1),p=w(null),A=a=>{p.value=a,f.value=!0},x=()=>{f.value=!1,p.value=null},B=()=>{M.delete(route("admin.incidentes-juridicos.destroy",p.value.id),{onSuccess:()=>x()})},v=R(()=>{const a=new URLSearchParams(h.pickBy(l.data())).toString();return route("admin.incidentes-juridicos.exportar")+"?"+a}),I=a=>{if(!a)return"N/A";const t={year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"};return new Date(a).toLocaleDateString("es-CO",t)},N=a=>({pendiente:"bg-yellow-100 text-yellow-800",en_revision:"bg-blue-100 text-blue-800",resuelto:"bg-green-100 text-green-800",archivado:"bg-gray-100 text-gray-800"})[a]||"bg-gray-200";return(a,t)=>(c(),d(b,null,[o(r(F),{title:"Gestión de Incidentes Jurídicos"}),o(P,null,{header:i(()=>[e("div",q,[e("h2",H,[o(r(L),{class:"h-6 w-6 inline-block mr-2"}),t[3]||(t[3]=n(" Gestión de Incidentes Jurídicos ",-1))]),e("div",K,[o(O,{align:"right",width:"48"},{trigger:i(()=>[o(D,null,{default:i(()=>t[4]||(t[4]=[n(" Acciones ",-1),e("svg",{class:"ms-2 -me-0.5 h-4 w-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M19.5 8.25l-7.5 7.5-7.5-7.5"})],-1)])),_:1,__:[4]})]),content:i(()=>[e("a",{href:`${v.value}&format=xlsx`,class:"block w-full px-4 py-2 text-start text-sm leading-5 text-gray-700 hover:bg-gray-100 focus:outline-none focus:bg-gray-100 transition duration-150 ease-in-out"},[e("div",W,[o(r($),{class:"h-4 w-4 mr-2"}),t[5]||(t[5]=n(" Exportar a Excel ",-1))])],8,Q),e("a",{href:`${v.value}&format=pdf`,target:"_blank",class:"block w-full px-4 py-2 text-start text-sm leading-5 text-gray-700 hover:bg-gray-100 focus:outline-none focus:bg-gray-100 transition duration-150 ease-in-out"},[e("div",Y,[o(r($),{class:"h-4 w-4 mr-2"}),t[6]||(t[6]=n(" Exportar a PDF ",-1))])],8,X)]),_:1}),o(r(E),{href:a.route("admin.incidentes-juridicos.create"),class:"inline-flex items-center px-4 py-2 bg-gray-800 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-gray-700 focus:bg-gray-700 active:bg-gray-900 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition ease-in-out duration-150"},{default:i(()=>[o(r(J),{class:"h-4 w-4 mr-2"}),t[7]||(t[7]=n(" Registrar Incidente ",-1))]),_:1,__:[7]},8,["href"])])])]),default:i(()=>[e("div",Z,[e("div",ee,[e("div",te,[e("div",se,[e("div",oe,[e("div",null,[t[8]||(t[8]=e("label",{for:"search",class:"block text-sm font-medium text-gray-700"},"Buscar por Asunto",-1)),y(e("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=s=>r(l).search=s),id:"search",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",placeholder:"Ej: derecho de petición..."},null,512),[[T,r(l).search]])]),e("div",null,[t[10]||(t[10]=e("label",{for:"estado",class:"block text-sm font-medium text-gray-700"},"Estado",-1)),y(e("select",{"onUpdate:modelValue":t[1]||(t[1]=s=>r(l).estado=s),id:"estado",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},t[9]||(t[9]=[e("option",{value:""},"Todos",-1),e("option",{value:"pendiente"},"Pendiente",-1),e("option",{value:"en_revision"},"En Revisión",-1),e("option",{value:"resuelto"},"Resuelto",-1),e("option",{value:"archivado"},"Archivado",-1)]),512),[[_,r(l).estado]])]),e("div",null,[t[12]||(t[12]=e("label",{for:"responsable_id",class:"block text-sm font-medium text-gray-700"},"Responsable",-1)),y(e("select",{"onUpdate:modelValue":t[2]||(t[2]=s=>r(l).responsable_id=s),id:"responsable_id",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"},[t[11]||(t[11]=e("option",{value:""},"Todos",-1)),(c(!0),d(b,null,k(m.usuarios,s=>(c(),d("option",{key:s.id,value:s.id},u(s.name),9,re))),128))],512),[[_,r(l).responsable_id]])])]),e("div",ae,[e("table",ie,[t[16]||(t[16]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Asunto"),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Responsable"),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Estado"),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Fecha de Registro"),e("th",{scope:"col",class:"relative px-6 py-3"},[e("span",{class:"sr-only"},"Acciones")])])],-1)),e("tbody",ne,[m.incidentes.data.length===0?(c(),d("tr",le,t[13]||(t[13]=[e("td",{colspan:"5",class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 text-center"}," No se encontraron incidentes con los filtros actuales. ",-1)]))):j("",!0),(c(!0),d(b,null,k(m.incidentes.data,s=>(c(),d("tr",{key:s.id},[e("td",de,[e("div",ce,u(s.asunto),1),e("div",ue,u(s.origen),1)]),e("td",me,u(s.responsable?s.responsable.name:"No asignado"),1),e("td",pe,[e("span",{class:U(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",N(s.estado)])},u(s.estado?s.estado.replace("_"," "):"N/A"),3)]),e("td",ge,u(I(s.fecha_registro)),1),e("td",fe,[e("div",xe,[o(r(E),{href:a.route("admin.incidentes-juridicos.show",s.id),class:"inline-flex items-center px-3 py-1 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-md font-semibold text-xs text-gray-700 dark:text-gray-300 uppercase tracking-widest shadow-sm hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none disabled:opacity-25 transition ease-in-out duration-150"},{default:i(()=>t[14]||(t[14]=[n(" Ver ",-1)])),_:2,__:[14]},1032,["href"]),o(C,{onClick:_e=>A(s),class:"!px-3 !py-1 !text-xs"},{default:i(()=>t[15]||(t[15]=[n(" Eliminar ",-1)])),_:2,__:[15]},1032,["onClick"])])])]))),128))])])]),e("div",ye,[o(z,{links:m.incidentes.links},null,8,["links"])])])])])]),o(G,{show:f.value,onClose:x},{default:i(()=>[e("div",be,[t[21]||(t[21]=e("h2",{class:"text-lg font-medium text-gray-900"}," ¿Estás seguro de que deseas eliminar este incidente? ",-1)),p.value?(c(),d("p",he,[t[17]||(t[17]=n(' Se eliminará permanentemente el incidente "',-1)),e("span",ve,u(p.value.asunto),1),t[18]||(t[18]=n('" y todos sus tickets y archivos asociados. Esta acción no se puede deshacer. ',-1))])):j("",!0),e("div",we,[o(D,{onClick:x},{default:i(()=>t[19]||(t[19]=[n(" Cancelar ",-1)])),_:1,__:[19]}),o(C,{class:"ms-3",onClick:B},{default:i(()=>t[20]||(t[20]=[n(" Sí, Eliminar Incidente ",-1)])),_:1,__:[20]})])])]),_:1},8,["show"])]),_:1})],64))}};export{Ve as default};
