import{r as u,k as f,z as w,O as V,c as r,o as l,d as C,i as B,f as E,a as M,F as S,e as F,x as q,t as p,A as D}from"./app-D6fBSztB.js";const L=["placeholder"],N={key:0,class:"absolute z-20 mt-1 w-full rounded-md border border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 shadow-lg max-h-60 overflow-auto"},O={key:0,class:"px-3 py-2 text-sm text-gray-500 dark:text-gray-400"},T={key:1},z=["onMousedown"],A={key:2,class:"px-3 py-2 text-sm text-gray-500 dark:text-gray-400"},I={key:3,class:"px-3 py-2 text-sm text-gray-500 dark:text-gray-400"},j={__name:"AsyncSelect",props:{modelValue:[Object,null],endpoint:{type:String,required:!0},minChars:{type:Number,default:2},placeholder:{type:String,default:"Buscar…"}},emits:["update:modelValue"],setup(i,{emit:h}){const n=i,x=h;function b(e,t){let o=null;return(...v)=>{clearTimeout(o),o=setTimeout(()=>e(...v),t)}}const m=u(null),a=u(""),d=u(!1),c=u(!1),s=u([]),y=b(async()=>{const e=a.value.trim();if(e.length<n.minChars){s.value=[];return}c.value=!0;try{const t=await D.get(n.endpoint,{params:{q:e}});s.value=t.data}catch(t){console.error("Error fetching async options:",t),s.value=[]}finally{c.value=!1}},300);f(a,e=>{var t;e!==(((t=n.modelValue)==null?void 0:t.label)??"")&&y()}),f(()=>n.modelValue,e=>{a.value=(e==null?void 0:e.label)??""},{immediate:!0});function k(e){a.value=e.label,x("update:modelValue",e),d.value=!1}function _(){d.value=!0,s.value.length===0&&a.value.length>=n.minChars&&y()}function g(e){var t;(t=m.value)!=null&&t.contains(e.target)||(d.value=!1)}return w(()=>{document.addEventListener("click",g)}),V(()=>{document.removeEventListener("click",g)}),(e,t)=>(l(),r("div",{ref_key:"root",ref:m,class:"relative"},[C(M("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=o=>a.value=o),placeholder:i.placeholder,onFocus:_,class:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-700 dark:bg-gray-900 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 text-sm",autocomplete:"off"},null,40,L),[[E,a.value]]),d.value?(l(),r("div",N,[c.value?(l(),r("div",O," Buscando… ")):s.value.length>0?(l(),r("div",T,[(l(!0),r(S,null,F(s.value,o=>(l(),r("button",{key:o.id,type:"button",onMousedown:q(v=>k(o),["prevent"]),class:"w-full text-left px-3 py-2 text-sm hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-200"},p(o.label),41,z))),128))])):a.value.length>=i.minChars?(l(),r("div",A,' Sin resultados para "'+p(a.value)+'" ',1)):(l(),r("div",I," Escribe para buscar... "))])):B("",!0)],512))}};export{j as _};
