import{q as E,s as w,r as C,c as l,o as d,b as r,u as a,h as N,w as p,a as e,g as n,x as R,d as A,F as g,e as v,t as i,v as D,n as z,i as _}from"./app-BQ1fBOAU.js";import{_ as B}from"./AuthenticatedLayout-Bawsgd7W.js";import{_ as k}from"./InputLabel-ZJL6u2KB.js";import{_ as G}from"./PrimaryButton-CAb3hnw6.js";import{D as T}from"./DangerButton-DuqT056S.js";import{_ as j}from"./Modal-Bv-J7BHH.js";import{_ as F}from"./SecondaryButton-CTAXiBUM.js";import{_ as b}from"./InputError-8Zq05OkV.js";import{_ as M}from"./TextInput-Dq4SX4hN.js";import{r as U}from"./BellAlertIcon-CneapFEy.js";import{r as q}from"./TrashIcon-gCeNqAER.js";import"./ApplicationLogo-CLvo8GpJ.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const I={class:"py-12"},P={class:"max-w-7xl mx-auto sm:px-6 lg:px-8 grid grid-cols-1 lg:grid-cols-3 gap-8"},L={class:"lg:col-span-1"},H={class:"bg-white dark:bg-gray-800 overflow-hidden shadow-sm sm:rounded-lg p-6"},J={class:"text-lg font-medium text-gray-900 dark:text-gray-100 flex items-center"},K=["value"],O=["value"],Q={class:"flex items-center justify-end"},W={class:"lg:col-span-2"},X={key:0,class:"mb-4 bg-green-100 border-l-4 border-green-500 text-green-700 p-4 rounded-md shadow-md",role:"alert"},Y={key:1,class:"mb-4 bg-red-100 border-l-4 border-red-500 text-red-700 p-4 rounded-md shadow-md",role:"alert"},Z={class:"bg-white dark:bg-gray-800 overflow-hidden shadow-sm sm:rounded-lg"},ee={class:"p-6 text-gray-900 dark:text-gray-100"},te={class:"overflow-x-auto"},se={class:"min-w-full divide-y divide-gray-200 dark:divide-gray-700"},ae={class:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700"},re={key:0},oe={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white"},le={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400 capitalize"},de={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400"},ie={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},ne=["onClick"],me={class:"p-6"},pe={key:0,class:"mt-2 text-sm text-gray-600 dark:text-gray-400"},ce={class:"font-bold capitalize"},ue={class:"font-bold"},ge={class:"mt-6 flex justify-end"},Se={__name:"Index",props:{reglas:Array,cooperativas:Array,tipos_proceso:Array,tipos_alerta:Array},setup(c){const x=c,u=E(),o=w({cooperativa_id:x.cooperativas.length>0?x.cooperativas[0].id:null,tipo:x.tipos_alerta[0],dias:30}),V=()=>{o.post(route("admin.reglas-alerta.store"),{onSuccess:()=>o.reset("dias")})},y=C(!1),m=C(null),$=h=>{m.value=h,y.value=!0},S=()=>{w({}).delete(route("admin.reglas-alerta.destroy",m.value.id),{preserveScroll:!0,onSuccess:()=>f()})},f=()=>{y.value=!1,m.value=null};return(h,t)=>(d(),l(g,null,[r(a(N),{title:"Gestión de Reglas de Alerta"}),r(B,null,{header:p(()=>t[3]||(t[3]=[e("h2",{class:"font-semibold text-xl text-gray-800 dark:text-gray-200 leading-tight"}," Gestión de Reglas de Alerta Automática ",-1)])),default:p(()=>[e("div",I,[e("div",P,[e("div",L,[e("div",H,[e("h3",J,[r(a(U),{class:"h-6 w-6 mr-2 text-indigo-500"}),t[4]||(t[4]=n(" Crear Nueva Regla ",-1))]),t[6]||(t[6]=e("p",{class:"mt-1 text-sm text-gray-600 dark:text-gray-400"}," Defina cuándo se deben generar las alertas automáticas. ",-1)),e("form",{onSubmit:R(V,["prevent"]),class:"mt-6 space-y-6"},[e("div",null,[r(k,{for:"cooperativa_id",value:"Para la Cooperativa"}),A(e("select",{"onUpdate:modelValue":t[0]||(t[0]=s=>a(o).cooperativa_id=s),id:"cooperativa_id",class:"mt-1 block w-full border-gray-300 dark:border-gray-700 dark:bg-gray-900 rounded-md shadow-sm"},[(d(!0),l(g,null,v(c.cooperativas,s=>(d(),l("option",{key:s.id,value:s.id},i(s.nombre),9,K))),128))],512),[[D,a(o).cooperativa_id]]),r(b,{class:"mt-2",message:a(o).errors.cooperativa_id},null,8,["message"])]),e("div",null,[r(k,{for:"tipo_alerta",value:"Tipo de Alerta"}),A(e("select",{"onUpdate:modelValue":t[1]||(t[1]=s=>a(o).tipo=s),id:"tipo_alerta",class:"mt-1 block w-full border-gray-300 dark:border-gray-700 dark:bg-gray-900 rounded-md shadow-sm capitalize"},[(d(!0),l(g,null,v(c.tipos_alerta,s=>(d(),l("option",{key:s,value:s},i(s.replace("_"," ")),9,O))),128))],512),[[D,a(o).tipo]]),r(b,{class:"mt-2",message:a(o).errors.tipo},null,8,["message"])]),e("div",null,[r(k,{for:"dias",value:"Generar Alerta a los (días)"}),r(M,{id:"dias",type:"number",class:"mt-1 block w-full",modelValue:a(o).dias,"onUpdate:modelValue":t[2]||(t[2]=s=>a(o).dias=s),required:"",min:"1"},null,8,["modelValue"]),r(b,{class:"mt-2",message:a(o).errors.dias},null,8,["message"])]),e("div",Q,[r(G,{class:z({"opacity-25":a(o).processing}),disabled:a(o).processing},{default:p(()=>t[5]||(t[5]=[n(" Guardar Regla ",-1)])),_:1,__:[5]},8,["class","disabled"])])],32)])]),e("div",W,[a(u).props.flash.success?(d(),l("div",X,[e("p",null,i(a(u).props.flash.success),1)])):_("",!0),a(u).props.flash.error?(d(),l("div",Y,[e("p",null,i(a(u).props.flash.error),1)])):_("",!0),e("div",Z,[e("div",ee,[t[9]||(t[9]=e("h3",{class:"text-lg font-medium mb-4"},"Reglas Actuales",-1)),e("div",te,[e("table",se,[t[8]||(t[8]=e("thead",{class:"bg-gray-50 dark:bg-gray-700"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},"Cooperativa"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},"Tipo de Alerta"),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider"},"Condición (Días)"),e("th",{class:"relative px-6 py-3"},[e("span",{class:"sr-only"},"Eliminar")])])],-1)),e("tbody",ae,[c.reglas.length===0?(d(),l("tr",re,t[7]||(t[7]=[e("td",{colspan:"4",class:"px-6 py-8 text-center text-gray-500 dark:text-gray-400"}," No hay reglas de alerta definidas. ",-1)]))):(d(!0),l(g,{key:1},v(c.reglas,s=>(d(),l("tr",{key:s.id,class:"hover:bg-gray-50 dark:hover:bg-gray-700/50"},[e("td",oe,i(s.cooperativa.nombre),1),e("td",le,i(s.tipo.replace("_"," ")),1),e("td",de,i(s.dias),1),e("td",ie,[e("button",{onClick:xe=>$(s),class:"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300"},[r(a(q),{class:"h-5 w-5"})],8,ne)])]))),128))])])])])])])])]),r(j,{show:y.value,onClose:f},{default:p(()=>[e("div",me,[t[15]||(t[15]=e("h2",{class:"text-lg font-medium text-gray-900 dark:text-gray-100"},"¿Eliminar Regla de Alerta?",-1)),m.value?(d(),l("p",pe,[t[10]||(t[10]=n(" Estás a punto de eliminar esta regla. El sistema dejará de generar alertas automáticas de tipo ",-1)),e("span",ce,i(m.value.tipo.replace("_"," ")),1),t[11]||(t[11]=n(" para la cooperativa ",-1)),e("span",ue,i(m.value.cooperativa.nombre),1),t[12]||(t[12]=n(". ",-1))])):_("",!0),e("div",ge,[r(F,{onClick:f},{default:p(()=>t[13]||(t[13]=[n(" Cancelar ",-1)])),_:1,__:[13]}),r(T,{class:"ms-3",onClick:S},{default:p(()=>t[14]||(t[14]=[n("Sí, Eliminar",-1)])),_:1,__:[14]})])])]),_:1},8,["show"])]),_:1})],64))}};export{Se as default};
