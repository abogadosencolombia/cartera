import{s as xo,r as m,k as f,l as D,c as S,o as x,b as s,u as o,h as Vo,w as p,a as l,x as zo,g,t as u,d as V,v as z,F as N,e as go,p as jo,n as To,A as Uo}from"./app-vy-57Nhv.js";import{_ as Eo}from"./AuthenticatedLayout-9dgdh7FW.js";import{_ as d}from"./InputError--M3O5c6A.js";import{_ as i}from"./InputLabel-CuoiynRR.js";import{_ as Bo}from"./PrimaryButton-fsUrTFHq.js";import{_}from"./TextInput-CHd6m527.js";import{C as v}from"./vue-select-D6REj2mX.js";import"./ApplicationLogo-jkf0VN9B.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const Oo={class:"font-semibold text-xl text-gray-800 dark:text-gray-200 leading-tight"},Po={class:"py-12"},wo={class:"max-w-4xl mx-auto sm:px-6 lg:px-8"},Mo={class:"bg-white dark:bg-gray-800 overflow-hidden shadow-sm sm:rounded-lg"},$o={class:"p-6 md:p-8 text-gray-900 dark:text-gray-100"},Do={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},No={class:"md:col-span-2"},Fo={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},Io=["value"],Go=["value"],Jo={class:"lg:col-span-3"},Ro={class:"md:col-span-2"},Lo={class:"flex items-center justify-end mt-8 border-t pt-6"},ae={__name:"Create",props:{casoAClonar:{type:Object,default:null},subtipos_proceso:{type:Array,default:()=>[]},etapas_procesales:{type:Array,default:()=>[]}},setup(O){var R,L,q,Z,H,K,Q,W,X,Y,oo,eo,ao,ro,lo,so,to,no,io,uo;const n=O,j=(r,e=a=>a)=>{const a=m([]),c=m("Escribe para buscar...");let co=null;return{options:a,onSearch:(M,po)=>{if(clearTimeout(co),M.length<3){if(a.value.length>0&&!M)return;a.value=[],c.value="Escribe al menos 3 caracteres...";return}po(!0),c.value="Buscando...",co=setTimeout(()=>{try{const $=route(r,{q:M});Uo.get($).then(B=>{if(Array.isArray(B.data)){const mo=B.data.map(e).filter(Boolean);a.value=mo,c.value=mo.length===0?"No se encontraron resultados.":""}else a.value=[],c.value="Error en la respuesta de la API."}).catch(B=>{console.error(`Error buscando en ${r}:`,B),a.value=[],c.value="Ocurrió un error al buscar."}).finally(()=>po(!1))}catch($){console.error(`Error de Ziggy: La ruta '${r}' no está definida.`,$),a.value=[],c.value="Error de configuración en la ruta."}},500)},message:c}},T=r=>r?{id:r.id,nombre:r.label||r.nombre}:null,F=r=>r?{id:r.id,name:r.label||r.name}:null,U=r=>{if(!r)return null;if(r.nombre_completo&&r.numero_documento)return r;if(typeof r.label=="string"){const e=r.label.match(/(.*) \((\S+)\)$/);if(e)return{id:r.id,nombre_completo:e[1].trim(),numero_documento:e[2]}}return{id:r.id,nombre_completo:r.label||r.nombre_completo||"Dato no válido",numero_documento:"N/A"}},{options:I,onSearch:fo,message:_o}=j("cooperativas.search",T),{options:G,onSearch:vo,message:bo}=j("users.search",F),{options:J,onSearch:Co,message:yo}=j("juzgados.search",T),{options:E,onSearch:P,message:w}=j("personas.search",U),t=xo({cooperativa_id:((R=n.casoAClonar)==null?void 0:R.cooperativa_id)||null,user_id:((L=n.casoAClonar)==null?void 0:L.user_id)||null,deudor_id:((q=n.casoAClonar)==null?void 0:q.deudor_id)||null,codeudor1_id:((Z=n.casoAClonar)==null?void 0:Z.codeudor1_id)||null,codeudor2_id:((H=n.casoAClonar)==null?void 0:H.codeudor2_id)||null,juzgado_id:((K=n.casoAClonar)==null?void 0:K.juzgado_id)||null,referencia_credito:((Q=n.casoAClonar)==null?void 0:Q.referencia_credito)||"",tipo_proceso:((W=n.casoAClonar)==null?void 0:W.tipo_proceso)||"ejecutivo singular",estado_proceso:"prejurídico",tipo_garantia_asociada:((X=n.casoAClonar)==null?void 0:X.tipo_garantia_asociada)||"codeudor",fecha_apertura:new Date().toISOString().slice(0,10),fecha_vencimiento:((Y=n.casoAClonar)==null?void 0:Y.fecha_vencimiento)||"",monto_total:((eo=(oo=n.casoAClonar)==null?void 0:oo.monto_total)==null?void 0:eo.toString())||"0",tasa_interes_corriente:((ro=(ao=n.casoAClonar)==null?void 0:ao.tasa_interes_corriente)==null?void 0:ro.toString())||"0",tasa_moratoria:((so=(lo=n.casoAClonar)==null?void 0:lo.tasa_moratoria)==null?void 0:so.toString())||"0",origen_documental:((to=n.casoAClonar)==null?void 0:to.origen_documental)||"pagaré",clonado_de_id:((no=n.casoAClonar)==null?void 0:no.id)||null,subtipo_proceso:((io=n.casoAClonar)==null?void 0:io.subtipo_proceso)||"",etapa_procesal:((uo=n.casoAClonar)==null?void 0:uo.etapa_procesal)||""}),b=m(null),C=m(null),y=m(null),A=m(null),h=m(null),k=m(null);if(f(b,r=>t.cooperativa_id=(r==null?void 0:r.id)??null),f(C,r=>t.user_id=(r==null?void 0:r.id)??null),f(y,r=>t.deudor_id=(r==null?void 0:r.id)??null),f(A,r=>t.codeudor1_id=(r==null?void 0:r.id)??null),f(h,r=>t.codeudor2_id=(r==null?void 0:r.id)??null),f(k,r=>t.juzgado_id=(r==null?void 0:r.id)??null),n.casoAClonar){n.casoAClonar.cooperativa&&(b.value=T({id:n.casoAClonar.cooperativa.id,label:n.casoAClonar.cooperativa.nombre}),I.value=[b.value]),n.casoAClonar.user&&(C.value=F({id:n.casoAClonar.user.id,label:n.casoAClonar.user.name}),G.value=[C.value]),n.casoAClonar.juzgado&&(k.value=T({id:n.casoAClonar.juzgado.id,label:n.casoAClonar.juzgado.nombre}),J.value=[k.value]);const r=[];n.casoAClonar.deudor&&(y.value=U(n.casoAClonar.deudor),r.push(y.value)),n.casoAClonar.codeudor1&&(A.value=U(n.casoAClonar.codeudor1),r.push(A.value)),n.casoAClonar.codeudor2&&(h.value=U(n.casoAClonar.codeudor2),r.push(h.value)),E.value=[...new Map(r.filter(Boolean).map(e=>[e.id,e])).values()]}const Ao=D(()=>n.casoAClonar?"Clonando Caso":"Registrar Nuevo Caso"),ho=D(()=>n.casoAClonar?`Clonando Caso #${n.casoAClonar.id}`:"Registrar Nuevo Caso"),ko=D(()=>n.casoAClonar?"Crear Copia del Caso":"Guardar Nuevo Caso"),So=()=>{t.post(route("casos.store"))};return(r,e)=>(x(),S(N,null,[s(o(Vo),{title:Ao.value},null,8,["title"]),s(Eo,null,{header:p(()=>[l("h2",Oo,u(ho.value),1)]),default:p(()=>[l("div",Po,[l("div",wo,[l("div",Mo,[l("div",$o,[l("form",{onSubmit:zo(So,["prevent"]),class:"space-y-8"},[l("section",null,[e[17]||(e[17]=l("h3",{class:"text-lg font-medium border-b pb-2 mb-6"},"Partes Involucradas",-1)),l("div",Do,[l("div",null,[s(i,{for:"cooperativa",value:"Cooperativa *"}),s(o(v),{id:"cooperativa",modelValue:b.value,"onUpdate:modelValue":e[0]||(e[0]=a=>b.value=a),options:o(I),label:"nombre",placeholder:"Escribe para buscar...",onSearch:o(fo),filterable:!1,appendToBody:!0,class:"mt-1 block w-full vue-select-style"},{"no-options":p(()=>[g(u(o(_o)),1)]),_:1},8,["modelValue","options","onSearch"]),s(d,{message:o(t).errors.cooperativa_id,class:"mt-2"},null,8,["message"])]),l("div",null,[s(i,{for:"abogado",value:"Abogado/Gestor a Cargo *"}),s(o(v),{id:"abogado",modelValue:C.value,"onUpdate:modelValue":e[1]||(e[1]=a=>C.value=a),options:o(G),label:"name",placeholder:"Escribe para buscar...",onSearch:o(vo),filterable:!1,appendToBody:!0,class:"mt-1 block w-full vue-select-style"},{"no-options":p(()=>[g(u(o(bo)),1)]),_:1},8,["modelValue","options","onSearch"]),s(d,{message:o(t).errors.user_id,class:"mt-2"},null,8,["message"])]),l("div",No,[s(i,{for:"deudor",value:"Deudor Principal *"}),s(o(v),{id:"deudor",modelValue:y.value,"onUpdate:modelValue":e[2]||(e[2]=a=>y.value=a),options:o(E),label:"nombre_completo",placeholder:"Escribe para buscar...",onSearch:o(P),filterable:!1,appendToBody:!0,class:"mt-1 block w-full vue-select-style"},{option:p(({nombre_completo:a,numero_documento:c})=>[l("span",null,u(a)+" ("+u(c)+")",1)]),"no-options":p(()=>[g(u(o(w)),1)]),_:1},8,["modelValue","options","onSearch"]),s(d,{message:o(t).errors.deudor_id,class:"mt-2"},null,8,["message"])]),l("div",null,[s(i,{for:"codeudor1",value:"Codeudor 1 (Opcional)"}),s(o(v),{id:"codeudor1",modelValue:A.value,"onUpdate:modelValue":e[3]||(e[3]=a=>A.value=a),options:o(E),label:"nombre_completo",placeholder:"Escribe para buscar...",onSearch:o(P),filterable:!1,appendToBody:!0,class:"mt-1 block w-full vue-select-style"},{option:p(({nombre_completo:a,numero_documento:c})=>[l("span",null,u(a)+" ("+u(c)+")",1)]),"no-options":p(()=>[g(u(o(w)),1)]),_:1},8,["modelValue","options","onSearch"]),s(d,{message:o(t).errors.codeudor1_id,class:"mt-2"},null,8,["message"])]),l("div",null,[s(i,{for:"codeudor2",value:"Codeudor 2 (Opcional)"}),s(o(v),{id:"codeudor2",modelValue:h.value,"onUpdate:modelValue":e[4]||(e[4]=a=>h.value=a),options:o(E),label:"nombre_completo",placeholder:"Escribe para buscar...",onSearch:o(P),filterable:!1,appendToBody:!0,class:"mt-1 block w-full vue-select-style"},{option:p(({nombre_completo:a,numero_documento:c})=>[l("span",null,u(a)+" ("+u(c)+")",1)]),"no-options":p(()=>[g(u(o(w)),1)]),_:1},8,["modelValue","options","onSearch"]),s(d,{message:o(t).errors.codeudor2_id,class:"mt-2"},null,8,["message"])])])]),l("section",null,[e[23]||(e[23]=l("h3",{class:"text-lg font-medium border-b pb-2 mb-6"},"Información del Crédito y Proceso",-1)),l("div",Fo,[l("div",null,[s(i,{for:"referencia_credito",value:"Referencia del Crédito"}),s(_,{modelValue:o(t).referencia_credito,"onUpdate:modelValue":e[5]||(e[5]=a=>o(t).referencia_credito=a),id:"referencia_credito",type:"text",class:"mt-1 block w-full"},null,8,["modelValue"]),s(d,{message:o(t).errors.referencia_credito,class:"mt-2"},null,8,["message"])]),l("div",null,[s(i,{for:"monto_total",value:"Monto Total *"}),s(_,{modelValue:o(t).monto_total,"onUpdate:modelValue":e[6]||(e[6]=a=>o(t).monto_total=a),id:"monto_total",type:"number",step:"0.01",class:"mt-1 block w-full"},null,8,["modelValue"]),s(d,{message:o(t).errors.monto_total,class:"mt-2"},null,8,["message"])]),l("div",null,[s(i,{for:"tasa_interes_corriente",value:"Tasa Interés Corriente (%) *"}),s(_,{modelValue:o(t).tasa_interes_corriente,"onUpdate:modelValue":e[7]||(e[7]=a=>o(t).tasa_interes_corriente=a),id:"tasa_interes_corriente",type:"number",step:"0.01",class:"mt-1 block w-full"},null,8,["modelValue"]),s(d,{message:o(t).errors.tasa_interes_corriente,class:"mt-2"},null,8,["message"])]),l("div",null,[s(i,{for:"tasa_moratoria",value:"Tasa Moratoria (%) *"}),s(_,{modelValue:o(t).tasa_moratoria,"onUpdate:modelValue":e[8]||(e[8]=a=>o(t).tasa_moratoria=a),id:"tasa_moratoria",type:"number",step:"0.01",class:"mt-1 block w-full"},null,8,["modelValue"]),s(d,{message:o(t).errors.tasa_moratoria,class:"mt-2"},null,8,["message"])]),l("div",null,[s(i,{for:"fecha_apertura",value:"Fecha de Apertura *"}),s(_,{modelValue:o(t).fecha_apertura,"onUpdate:modelValue":e[9]||(e[9]=a=>o(t).fecha_apertura=a),id:"fecha_apertura",type:"date",class:"mt-1 block w-full"},null,8,["modelValue"]),s(d,{message:o(t).errors.fecha_apertura,class:"mt-2"},null,8,["message"])]),l("div",null,[s(i,{for:"fecha_vencimiento",value:"Fecha de Vencimiento"}),s(_,{modelValue:o(t).fecha_vencimiento,"onUpdate:modelValue":e[10]||(e[10]=a=>o(t).fecha_vencimiento=a),id:"fecha_vencimiento",type:"date",class:"mt-1 block w-full"},null,8,["modelValue"]),s(d,{message:o(t).errors.fecha_vencimiento,class:"mt-2"},null,8,["message"])]),l("div",null,[s(i,{for:"tipo_proceso",value:"Tipo de Proceso *"}),V(l("select",{"onUpdate:modelValue":e[11]||(e[11]=a=>o(t).tipo_proceso=a),id:"tipo_proceso",class:"mt-1 block w-full border-gray-300 dark:border-gray-700 dark:bg-gray-900 rounded-md shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},e[18]||(e[18]=[l("option",null,"ejecutivo singular",-1),l("option",null,"hipotecario",-1),l("option",null,"prendario",-1),l("option",null,"libranza",-1)]),512),[[z,o(t).tipo_proceso]]),s(d,{message:o(t).errors.tipo_proceso,class:"mt-2"},null,8,["message"])]),l("div",null,[s(i,{for:"subtipo_proceso",value:"Subtipo de Proceso"}),V(l("select",{"onUpdate:modelValue":e[12]||(e[12]=a=>o(t).subtipo_proceso=a),id:"subtipo_proceso",class:"mt-1 block w-full border-gray-300 dark:border-gray-700 dark:bg-gray-900 rounded-md shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},[e[19]||(e[19]=l("option",{value:""},"-- Sin especificar --",-1)),(x(!0),S(N,null,go(O.subtipos_proceso,a=>(x(),S("option",{key:a,value:a},u(a),9,Io))),128))],512),[[z,o(t).subtipo_proceso]]),s(d,{class:"mt-2",message:o(t).errors.subtipo_proceso},null,8,["message"])]),l("div",null,[s(i,{for:"etapa_procesal",value:"Etapa Procesal"}),V(l("select",{"onUpdate:modelValue":e[13]||(e[13]=a=>o(t).etapa_procesal=a),id:"etapa_procesal",class:"mt-1 block w-full border-gray-300 dark:border-gray-700 dark:bg-gray-900 rounded-md shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},[e[20]||(e[20]=l("option",{value:""},"-- Sin especificar --",-1)),(x(!0),S(N,null,go(O.etapas_procesales,a=>(x(),S("option",{key:a,value:a},u(a),9,Go))),128))],512),[[z,o(t).etapa_procesal]]),s(d,{class:"mt-2",message:o(t).errors.etapa_procesal},null,8,["message"])]),l("div",Jo,[s(i,{for:"juzgado",value:"Juzgado"}),s(o(v),{id:"juzgado",modelValue:k.value,"onUpdate:modelValue":e[14]||(e[14]=a=>k.value=a),options:o(J),label:"nombre",placeholder:"Escribe para buscar un juzgado...",onSearch:o(Co),filterable:!1,appendToBody:!0,class:"mt-1 block w-full vue-select-style"},{"no-options":p(()=>[g(u(o(yo)),1)]),_:1},8,["modelValue","options","onSearch"]),s(d,{class:"mt-2",message:o(t).errors.juzgado_id},null,8,["message"])]),l("div",null,[s(i,{for:"tipo_garantia_asociada",value:"Tipo de Garantía *"}),V(l("select",{"onUpdate:modelValue":e[15]||(e[15]=a=>o(t).tipo_garantia_asociada=a),id:"tipo_garantia_asociada",class:"mt-1 block w-full border-gray-300 dark:border-gray-700 dark:bg-gray-900 rounded-md shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},e[21]||(e[21]=[l("option",null,"codeudor",-1),l("option",null,"hipotecaria",-1),l("option",null,"prendaria",-1),l("option",null,"sin garantía",-1)]),512),[[z,o(t).tipo_garantia_asociada]]),s(d,{message:o(t).errors.tipo_garantia_asociada,class:"mt-2"},null,8,["message"])]),l("div",Ro,[s(i,{for:"origen_documental",value:"Origen Documental *"}),V(l("select",{"onUpdate:modelValue":e[16]||(e[16]=a=>o(t).origen_documental=a),id:"origen_documental",class:"mt-1 block w-full border-gray-300 dark:border-gray-700 dark:bg-gray-900 rounded-md shadow-sm focus:border-indigo-500 focus:ring-indigo-500"},e[22]||(e[22]=[l("option",null,"pagaré",-1),l("option",null,"libranza",-1),l("option",null,"contrato",-1),l("option",null,"otro",-1)]),512),[[z,o(t).origen_documental]]),s(d,{message:o(t).errors.origen_documental,class:"mt-2"},null,8,["message"])])])]),l("div",Lo,[s(o(jo),{href:r.route("casos.index"),class:"text-sm text-gray-600 dark:text-gray-400 hover:underline mr-4"},{default:p(()=>e[24]||(e[24]=[g("Cancelar",-1)])),_:1,__:[24]},8,["href"]),s(Bo,{class:To({"opacity-25":o(t).processing}),disabled:o(t).processing},{default:p(()=>[g(u(ko.value),1)]),_:1},8,["class","disabled"])])],32)])])])])]),_:1})],64))}};export{ae as default};
