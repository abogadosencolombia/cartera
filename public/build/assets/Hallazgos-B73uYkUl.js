import{r as p,z as f,c as r,o as i,b as k,a as t,u as A,h as D,i as g,g as m,d as w,f as z,t as e,F as _,e as V,A as C}from"./app-vy-57Nhv.js";import{_ as N}from"./AuthenticatedLayout-9dgdh7FW.js";import"./ApplicationLogo-jkf0VN9B.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const B={class:"py-6"},E={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},H={class:"flex items-center gap-3 mb-4"},I={class:"text-sm text-gray-600"},$=["disabled"],F={key:0,class:"mb-4 px-4 py-3 rounded border border-red-200 bg-red-50 text-red-700 text-sm"},M={class:"bg-white rounded shadow overflow-x-auto"},R={class:"min-w-full divide-y divide-gray-200"},S={class:"bg-white divide-y divide-gray-100"},T={key:0},U={class:"px-4 py-4 text-sm text-gray-500",colspan:"7"},j={class:"px-4 py-3 text-sm text-gray-700"},q={class:"px-4 py-3 text-sm text-gray-700"},L={class:"px-4 py-3 text-sm text-gray-700"},O={class:"px-4 py-3 text-sm text-gray-700"},P={class:"px-4 py-3 text-sm text-gray-700"},G={class:"px-4 py-3 text-sm text-gray-700"},J={class:"px-4 py-3 text-sm text-gray-700"},K={layout:N},tt=Object.assign(K,{__name:"Hallazgos",props:{defaultDays:{type:Number,default:30}},setup(h){const l=p(h.defaultDays),n=p([]),d=p(!1),c=p(""),x=async()=>{var u,a,s;d.value=!0,c.value="";try{const{data:o}=await C.get("/alertas/hallazgos",{params:{days:l.value}});n.value=Array.isArray(o.items)?o.items:[]}catch(o){const y=(u=o==null?void 0:o.response)==null?void 0:u.status,b=((s=(a=o==null?void 0:o.response)==null?void 0:a.data)==null?void 0:s.message)||"No fue posible cargar los datos. Verifica que la API responda y la sesión esté activa.";c.value=(y?`[${y}] `:"")+b,n.value=[]}finally{d.value=!1}},v=()=>{window.location.href=`/api/alertas/hallazgos/export?days=${encodeURIComponent(l.value)}`};return f(x),(u,a)=>(i(),r(_,null,[k(A(D),{title:"Alertas - Hallazgos"}),t("div",B,[t("div",E,[a[3]||(a[3]=t("h1",{class:"text-2xl font-semibold mb-4"},[m(" Alertas "),t("span",{class:"text-orange-600"},"Hallazgos")],-1)),t("div",H,[t("label",I,[a[1]||(a[1]=m(" Días ",-1)),w(t("input",{type:"number",class:"ml-2 border rounded px-2 py-1 w-20",min:"1","onUpdate:modelValue":a[0]||(a[0]=s=>l.value=s)},null,512),[[z,l.value,void 0,{number:!0}]])]),t("button",{class:"px-4 py-2 rounded bg-indigo-600 text-white hover:bg-indigo-700 disabled:opacity-50",disabled:d.value,onClick:x},e(d.value?"Cargando…":"Actualizar"),9,$),t("button",{class:"px-4 py-2 rounded bg-gray-800 text-white hover:bg-gray-900",onClick:v}," Descargar ")]),c.value?(i(),r("div",F,e(c.value),1)):g("",!0),t("div",M,[t("table",R,[a[2]||(a[2]=t("thead",{class:"bg-gray-50"},[t("tr",{class:"text-left text-xs font-semibold text-gray-600 uppercase tracking-wider"},[t("th",{class:"px-4 py-3"},"ID"),t("th",{class:"px-4 py-3"},"Rad. Corto"),t("th",{class:"px-4 py-3"},"Etapa"),t("th",{class:"px-4 py-3"},"Últ. Actuación"),t("th",{class:"px-4 py-3"},"Vencimiento"),t("th",{class:"px-4 py-3"},"Días sin gestión"),t("th",{class:"px-4 py-3"},"Encargado")])],-1)),t("tbody",S,[!d.value&&n.value.length===0?(i(),r("tr",T,[t("td",U," Sin resultados para los últimos "+e(l.value)+" días. ",1)])):g("",!0),(i(!0),r(_,null,V(n.value,s=>(i(),r("tr",{key:s.id},[t("td",j,e(s.id),1),t("td",q,e(s.rad_corto),1),t("td",L,e(s.etapa),1),t("td",O,e(s.ultima_actuacion),1),t("td",P,e(s.vencimiento),1),t("td",G,e(s.dias_sin_gestion),1),t("td",J,e(s.encargado),1)]))),128))])])])])])],64))}});export{tt as default};
